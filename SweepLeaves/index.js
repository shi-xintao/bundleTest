window.__require=function t(e,i,n){function o(s,l){if(!i[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var r="function"==typeof __require&&__require;if(!l&&r)return r(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){return o(e[s][1][t]||t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({Constant:[function(t,e,i){"use strict";cc._RF.push(e,"68584KdAfJBM4cE9OW5WEos","Constant"),Object.defineProperty(i,"__esModule",{value:!0}),i.loadSpriteFrame=i.playSpineAnimation=void 0,i.playSpineAnimation=function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=0),!i)return new Promise(function(o){var a=t.setAnimation(n,e,i);t.setTrackCompleteListener(a,function(){o(null)})});Promise.resolve().then(function(){t.setAnimation(n,e,i)})},i.loadSpriteFrame=function(t){return new Promise(function(e){cc.resources.load(t,cc.SpriteFrame,function(t,i){t?console.log(t,"SpriteFrame \u52a0\u8f7d\u5931\u8d25===============>>"):e(i)})})},cc._RF.pop()},{}],SweepLeaves:[function(t,e,i){"use strict";cc._RF.push(e,"8005fWVQilLKL/LoQOQIMUc","SweepLeaves");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,s=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,i,s):o(e,i))||s);return a>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,a){function s(t){try{c(n.next(t))}catch(e){a(e)}}function l(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,l)}c((n=n.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var i,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(t){return function(e){return c([t,e])}}function c(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(l){a=[6,l],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c,r,u,h,d=t("../../../kit/system/audio/AudioManager"),p=t("../../../kit/system/event/EventSystem"),f=t("../../../kit/events/events"),y=t("./Constant"),m=t("../../../kit/system/timer/TimerSystem"),S=cc._decorator.ccclass;(function(t){t.DOUBT="doubt",t.EXCITED="excited",t.HAPPY="happy",t.RUN="run",t.SAD="sad",t.STAY="stay",t.STAY_YAO_QIU="stay-yaoqiu",t.YAO_QIU="yaoqiu",t.STAY_YAO_RUN="yaoqiu-run"})(c||(c={})),function(t){t.IDLE="saoba-stay",t.RUN="saoba"}(r||(r={})),function(t){t.IDLE="naopao-2",t.SHOW="naopao-1",t.HIDE="naopao-3"}(u||(u={})),function(t){t.YELLOW="yellow",t.RED="red",t.BG_MUSIC="bg",t.SEAL="SE_luoyefense_03",t.LEAF_SAO="SE_luoyefense_04",t.DOG_SAD="SE_luoyefense_01",t.START="1_womenkaishiba",t.SO_GOOD="2_youaresogood",t.kEEP_TRYING="3_keeptrying",t.COOL="4_cool",t.PREFECT="5_perfect",t.GONG_XI="6_congratulations"}(h||(h={}));var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dogSk=null,e.bubbleSk=null,e.broomSk=null,e.starSk=null,e.leafContent=null,e.ballContent=null,e.tigoHead=null,e.taskNode=null,e.hideTaskBtn=null,e.gameAudioIndex=0,e.gameIndex=0,e.gameTaskIndex=0,e.isTaskShow=!1,e.moveLen=400,e.taskHideTime=4,e.moveTime=.5,e.bubble_skin=["yezi","huangqiu","hongqiu","huangqiu"],e.leafIndex=[],e.taskCallback=function(){},e.gameTotal=4,e.isClicking=!1,e.gameWordData=["","\u9ec4\u8272","\u7ea2\u8272","\u9ec4\u8272"],e.gameWordAudio=["","yellow","red","yellow"],e.MUSIC_PATH="audio/",e.BUNDLE_NAME="SweepLeaves",e}return o(e,t),e.prototype.onLoad=function(){p.default.on(f.FOLLOW_MODULE_TO_CLIENT,this.recordResult,this)},e.prototype.start=function(){this.initAllNode(),this.initOnClickLeafNode(),this.initOtherNodeMes(),this.initTaskNodeMes(),this.startRunGame(),p.default.on(f.LIFE_CYCLE_BLOCK,this.block,this),p.default.on(f.LIFE_CYCLE_UNBLOCK,this.onBlock,this),this.palyBGM()},e.prototype.block=function(){},e.prototype.onBlock=function(){},e.prototype.onDestroy=function(){p.default.off(f.FOLLOW_MODULE_TO_CLIENT,this.recordResult,this),p.default.off(f.LIFE_CYCLE_BLOCK,this.block,this),p.default.off(f.LIFE_CYCLE_UNBLOCK,this.onBlock,this),cc.isValid(this.node)&&this.node.destroy()},e.prototype.initAllNode=function(){this.dogSk=this.getSpineByNode("dogNode"),this.starSk=this.getSpineByNode("starNode"),this.broomSk=this.getSpineByNode("broomNode"),this.bubbleSk=this.getSpineByNode("bubbleNode"),this.leafContent=this.node.getChildByName("leafContent"),this.ballContent=this.node.getChildByName("ballContent"),this.taskNode=this.node.getChildByName("TaskList"),this.hideTaskBtn=this.node.getChildByName("hideTaskBtn"),this.tigoHead=this.node.getChildByName("tigoHead")},e.prototype.initOtherNodeMes=function(){this.hideTaskBtn.active=!1,this.hideTigoHeadAnimation()},e.prototype.initOnClickLeafNode=function(){var t=this;this.leafContent.children.forEach(function(e){e.on(cc.Node.EventType.TOUCH_END,function(e){t.onClickLeaf(e)},t)})},e.prototype.onClickLeaf=function(t){if(!this.isClicking){this.isClicking=!0,this.leafIndex.push(t.target.name),this.gameAudioIndex++;var e=t.target.children[0];e&&(e.active=!0,e.getComponent(sp.Skeleton)),this.playBroomAnimation(t.target),this.palyAudioByIdx(t.target.name)}},e.prototype.playBroomAnimation=function(t){var e=this;this.broomSk.node.active=!0;var i=t.getPosition();this.broomSk.node.setPosition(i.x,i.y-130),d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.LEAF_SAO),this.scheduleOnce(function(){e.playBroomEndAnimation(t)},3)},e.prototype.playBroomEndAnimation=function(t){var e=this;cc.tween(t).to(.5,{opacity:0}).call(function(){e.playAudioByName(),t.active=!1,e.broomSk.node.active=!1,e.nextGameLevel()}).start()},e.prototype.nextGameLevel=function(){return s(this,void 0,void 0,function(){var t=this;return l(this,function(){return this.isClicking=!1,this.leafIndex.length<4?(this.palyDogHappyAnimation(),[2]):(this.gameAudioIndex++,this.gameIndex++,1===this.gameIndex||this.gameIndex===this.gameTotal?(1===this.gameIndex&&(this.showStarAnimation(),this.palyDogExcitedAnimation()),m.default.instance.doFrameOnce(1,function(){return s(t,void 0,void 0,function(){var t=this;return l(this,function(){return this.showTaskList(!1,function(){t.showSealSpine(function(){t.hideTaskList(function(){if(t.hideSealSpine(),t.hideStarAnimation(),t.gameIndex>=t.gameTotal)return d.default.stopMusic(),p.default.emit(f.LIFE_CYCLE_COMPLETE),t.palyDogHappyAnimation(!0),void cc.log("\u6e38\u620f\u7ed3\u675f~~");cc.log("\u6e38\u620f\u7ee7\u7eed~~"),t.palyDogIdleAnimation(),t.initBubbleMes(),t.gameTaskIndex++,t.showTaskList(),t.showTigoHeadAnimation(function(){t.gameRunRecord()})})})}),[2]})})})):(cc.log("\u6e38\u620f\u7ee7\u7eed~~ing"),this.initBubbleMes(),this.showTigoHeadAnimation(function(){t.gameRunRecord()})),[2])})})},e.prototype.showTigoHeadAnimation=function(t){var e=this.bubble_skin[this.gameIndex],i=this.ballContent.getChildByName(e);i&&e&&(i.active=!0,cc.tween(i).to(.5,{x:i.x-200,y:i.y+250}),cc.tween(i).to(.5,{x:i.x-400,y:i.y+400}),cc.tween(i).to(.5,{x:0,y:0,scale:.5}).delay(1).call(function(){t&&t()}).start())},e.prototype.hideTigoHeadAnimation=function(){var t=this;this.ballContent.children.forEach(function(e){e.active=!1,e.setPosition(t.tigoHead.getPosition())})},e.prototype.showStarAnimation=function(){this.starSk.node.active=!0},e.prototype.hideStarAnimation=function(){this.starSk.node.active=!1},e.prototype.palyDogHappyAnimation=function(t){var e=this;void 0===t&&(t=!1),t?y.playSpineAnimation(this.dogSk,c.HAPPY,!0):y.playSpineAnimation(this.dogSk,c.HAPPY).then(function(){y.playSpineAnimation(e.dogSk,c.STAY,!0)})},e.prototype.palyDogExcitedAnimation=function(){var t=this;y.playSpineAnimation(this.dogSk,c.EXCITED).then(function(){y.playSpineAnimation(t.dogSk,c.STAY,!0)})},e.prototype.palyDogIdleAnimation=function(){y.playSpineAnimation(this.dogSk,c.STAY,!0)},e.prototype.setDogBallAnimation=function(){var t=this.bubble_skin[this.gameIndex];this.dogSk.clearTracks(),this.dogSk.setToSetupPose(),this.dogSk.setSkin(t)},e.prototype.palyDogBallRightAnimation=function(){var t=this;this.setDogBallAnimation();var e=this.dogSk.node.position,i=this.bubble_skin[this.gameIndex];this.ballContent.getChildByName(i),cc.tween(this.dogSk.node).call(function(){y.playSpineAnimation(t.dogSk,c.RUN,!0)}).to(2,{x:-184,y:-91,scale:.8}).call(function(){t.hideTigoHeadAnimation(),y.playSpineAnimation(t.dogSk,c.YAO_QIU).then(function(){t.dogSk.node.scaleX=-t.dogSk.node.scaleX,y.playSpineAnimation(t.dogSk,c.STAY_YAO_RUN,!0),cc.tween(t.dogSk.node).to(2,{position:e,scaleX:-1,scaleY:1}).call(function(){t.dogSk.node.scaleX=1,y.playSpineAnimation(t.dogSk,c.STAY_YAO_QIU,!0)}).delay(1).call(function(){t.nextGameLevel()}).start()})}).start()},e.prototype.palyDogBallWrongAnimation=function(){var t=this;y.playSpineAnimation(this.dogSk,c.DOUBT).then(function(){y.playSpineAnimation(t.dogSk,c.STAY,!0),t.nextGameLevel()})},e.prototype.palyBGM=function(){d.default.playMusic(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.BG_MUSIC)},e.prototype.palyAudioByIdx=function(t){Number(t)<=2?d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.YELLOW):d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.RED)},e.prototype.initTaskNodeMes=function(){var t=this;if(this.taskNode){var e=this.taskNode.getChildByName("di"),i=cc.view.getFrameSize().width/2+e.width/2;this.moveLen=e.width,cc.log(i,"this.moveLen===",this.moveLen),this.taskNode.getChildByName("content").children.forEach(function(e,i){e.active=i===t.gameTaskIndex})}},e.prototype.showTaskList=function(t,e){var i=this;void 0===t&&(t=!0),console.log("showTaskList~~~"),this.initTaskNodeMes(),this.setTaskCallBack(),this.isTaskShow||(this.isTaskShow=!this.isTaskShow,cc.tween(this.taskNode).by(this.moveTime,{x:-this.moveLen}).delay(1).call(function(){i.hideTaskBtn.active=t,e&&e()}).start())},e.prototype.hideTaskList=function(t){var e=this;this.cancelTaskCallBack(),console.log("hideTaskList~~~"),this.isTaskShow&&(this.isTaskShow=!this.isTaskShow,this.hideTaskBtn.active=!1,cc.tween(this.taskNode).by(this.moveTime,{x:this.moveLen}).call(function(){t&&t(),0===e.gameAudioIndex&&e.playAudioByName()}).start())},e.prototype.setTaskCallBack=function(){var t=this;this.scheduleOnce(this.taskCallback=function(){t.hideTaskList()},this.taskHideTime)},e.prototype.cancelTaskCallBack=function(){this.taskCallback&&this.unschedule(this.taskCallback)},e.prototype.getSpineByNode=function(t){var e=this.node.getChildByName(t);return e?e.getComponent(sp.Skeleton)||(cc.warn(e.name+"  \u6b64\u8282\u70b9\u4e0d\u5b58\u5728\u9aa8\u9abc\u7ec4\u4ef6"),null):(cc.warn(t+"  \u6b64\u8282\u70b9\u4e0d\u5b58\u5728"),null)},e.prototype.startRunGame=function(){return s(this,void 0,void 0,function(){var t=this;return l(this,function(){return d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.DOG_SAD),y.playSpineAnimation(this.dogSk,c.SAD,!0),this.initBubbleMes(),m.default.instance.doFrameOnce(1,function(){t.showTaskList()}),[2]})})},e.prototype.initBubbleMes=function(){var t=this.bubble_skin[this.gameIndex];cc.log("bubbleName===",t),this.showBubbleSpine(t)},e.prototype.showBubbleSpine=function(t){var e=this;this.bubbleSk.setSkin(t),this.bubbleSk.clearTracks(),this.bubbleSk.setToSetupPose(),y.playSpineAnimation(this.bubbleSk,u.SHOW).then(function(){y.playSpineAnimation(e.bubbleSk,u.IDLE,!0),e.scheduleOnce(function(){y.playSpineAnimation(e.bubbleSk,u.HIDE)},2.5)})},e.prototype.showSealSpine=function(t){var e=this.taskNode.getChildByName("sealNode");e.active=!0;var i=e.getComponent(sp.Skeleton);this.playAudioByName(),i.setToSetupPose(),cc.tween(e).delay(2).call(function(){t&&t()}).start(),d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.SEAL)},e.prototype.hideSealSpine=function(){var t=this.taskNode.getChildByName("sealNode");t&&(t.getComponent(sp.Skeleton).setToSetupPose(),t.active=!1)},e.prototype.onClickTaskBtn=function(){this.hideTaskList()},e.prototype.gameRunRecord=function(){var t=this;cc.log("gameRunRecord~~~"),this.scheduleOnce(function(){var e={evaluatingType:1,evaluatingText:t.gameWordData[t.gameIndex],tryTimes:1,evaluationScore:30,recordTime:3};p.default.emit(f.FOLLOW_CLIENT_TO_MODULE,{eventName:"initComponent",extra:e}),p.default.emit(f.FOLLOW_CLIENT_TO_MODULE,{eventName:"startRecord"})},2.5),d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+this.gameWordAudio[this.gameIndex])},e.prototype.recordResult=function(t){console.log("recordResult",t.data),"ResultCb"==t.data.eventName&&(t.data.success?this.palyDogBallRightAnimation():this.palyDogBallWrongAnimation())},e.prototype.playAudioByName=function(){switch(this.gameAudioIndex){case 0:d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.START);break;case 1:d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.SO_GOOD);break;case 2:d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.kEEP_TRYING);break;case 3:d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.COOL);break;case 4:d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.PREFECT);break;default:d.default.playEffect(this.BUNDLE_NAME,""+this.MUSIC_PATH+h.GONG_XI)}},e.prototype.playSpineByName=function(t,e,i){t.setAnimation(0,e,!1),t.setEndListener(function(){cc.log("setEndListener"),t.addAnimation(0,i,!0)})},a([S],e)}(cc.Component);i.default=k,cc._RF.pop()},{"../../../kit/events/events":void 0,"../../../kit/system/audio/AudioManager":void 0,"../../../kit/system/event/EventSystem":void 0,"../../../kit/system/timer/TimerSystem":void 0,"./Constant":"Constant"}]},{},["Constant","SweepLeaves"]);