window.__require=function t(o,e,i){function n(c,a){if(!e[c]){if(!o[c]){var s=c.split("/");if(s=s[s.length-1],!o[s]){var p="function"==typeof __require&&__require;if(!a&&p)return p(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var d=e[c]={exports:{}};o[c][0].call(d.exports,function(t){return n(o[c][1][t]||t)},d,d.exports,t,o,e,i)}return e[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<i.length;c++)n(i[c]);return n}({kongItem:[function(t,o,e){"use strict";cc._RF.push(o,"10391NK2q5PGJrYmT7ajfh5","kongItem");var i,n=this&&this.__extends||(i=function(t,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}i(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}),r=this&&this.__decorate||function(t,o,e,i){var n,r=arguments.length,c=r<3?o:null===i?i=Object.getOwnPropertyDescriptor(o,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(o,e,c):n(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.maskNode=null,o.maskSpArr=[],o.itemSp=null,o.itemSpArr=[],o.colorAniNode=null,o.mainCom=null,o.mid=0,o.mround=0,o.posiArr=[cc.v3(-.88,18.55,0),cc.v3(.7,-12.3,0),cc.v3(-16,-.8,0),cc.v3(35.4,16,0)],o.posiMaskArr=[cc.v3(2.2,-18.5,0),cc.v3(.5,12.5,0),cc.v3(18,1.2,0),cc.v3(-35,-16,0)],o.colorAniArr=[cc.v3(-250,15,0),cc.v3(-262,36.5,0),cc.v3(-262,80,0),cc.v3(-230,30,0)],o}return n(o,t),o.prototype.start=function(){this.colorAniNode.setCompleteListener(this.colorAniNodeback.bind(this)),this.node.position=this.posiArr[this.mround],this.itemSp.spriteFrame=this.itemSpArr[this.mround],this.maskNode.node.position=this.posiMaskArr[this.mround],this.colorAniNode.node.position=this.colorAniArr[this.mround],this.node.x=800,this.startAni()},o.prototype.initItem=function(t,o,e){this.mid=t,this.mround=o,this.mainCom=e},o.prototype.startAni=function(){var t=this;cc.tween(this.node).to(2,{position:this.posiArr[this.mround]}).call(function(){t.mainCom.setBlock(!1)}).start()},o.prototype.splashColor=function(){this.colorAniNode.node.active=!0,this.playAin(this.mround)},o.prototype.playAin=function(t,o){void 0===o&&(o=!1);var e="";switch(t){case 0:e="lan";break;case 1:e="hong";break;case 2:e="huang";break;case 3:e="lan1"}this.playSpine(this.colorAniNode,e,o)},o.prototype.colorAniNodeback=function(){this.mainCom.showPaintSp(),this.turnOnMask()},o.prototype.turnOnMask=function(){var t=this;this.maskNode.enabled=!0,this.maskNode.spriteFrame=this.maskSpArr[this.mround],this.maskNode.node.width=this.maskSpArr[this.mround].getRect().width,this.maskNode.node.height=this.maskSpArr[this.mround].getRect().height,this.scheduleOnce(function(){return t.moveOut()},2)},o.prototype.moveOut=function(){var t=this;cc.tween(this.node).by(2,{x:750}).call(function(){t.mainCom.roundEnd(),t.node.destroy()}).start()},o.prototype.playSpine=function(t,o,e){t.clearTracks(),t.setToSetupPose(),t.setAnimation(0,o,e)},r([s(cc.Mask)],o.prototype,"maskNode",void 0),r([s(cc.SpriteFrame)],o.prototype,"maskSpArr",void 0),r([s(cc.Sprite)],o.prototype,"itemSp",void 0),r([s(cc.SpriteFrame)],o.prototype,"itemSpArr",void 0),r([s(sp.Skeleton)],o.prototype,"colorAniNode",void 0),r([a],o)}(cc.Component);e.default=p,cc._RF.pop()},{}],paintingColor:[function(t,o,e){"use strict";cc._RF.push(o,"5a827GZvNZMt59B3nIN0w2R","paintingColor");var i,n=this&&this.__extends||(i=function(t,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}i(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}),r=this&&this.__decorate||function(t,o,e,i){var n,r=arguments.length,c=r<3?o:null===i?i=Object.getOwnPropertyDescriptor(o,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(o,e,c):n(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});var c=t("../../../kit/events/events"),a=t("../../../kit/system/audio/AudioManager"),s=t("../../../kit/system/event/EventSystem"),p=cc._decorator,d=p.ccclass,u=p.property,h=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.paintSp=null,o.paintSpArr=[],o.boardSp=null,o.boardSpArr=[],o.kongItem=null,o.itemBoard=null,o.lightNode=null,o.boxNode=null,o.showNode=null,o.bgSp=null,o.bgSpArr=[],o.fachen=null,o.dolphineAin=null,o.heiyanAin=null,o.blockNode=null,o.overTag=!0,o.cur_index=0,o.sounds_arr=["blue","red","yel","blue"],o.gameWordData=["\u84dd\u8272"],o.taskData=null,o.gameTaskCom=null,o}return n(o,t),o.prototype.onLoad=function(){s.default.on(c.FOLLOW_MODULE_TO_CLIENT,this.recordResult,this)},o.prototype.start=function(){var t=this;this.dolphineAin.setCompleteListener(this.dolphineAinback.bind(this)),s.default.emit(c.LIFE_CYCLE_CREATED),s.default.on(c.LIFE_CYCLE_BLOCK,this.onBlock,this),s.default.on(c.LIFE_CYCLE_UNBLOCK,this.unBlock,this),this.taskData={bundleName:"paintingColor",imgList:["res/task1","res/task2"]},this.initTaskComp(),this.scheduleOnce(function(){t.myShowTaskFun(0,!1)},1)},o.prototype.myShowTaskFun=function(t,o){var e=this,i={taskIndex:t,complete:o,callFunc3:function(){switch(t){case 0:o?e.showGameTow():(e.node.getChildByName("paintboard").active=!0,e.boxNode.active=!0,e.assembleItem());break;case 1:o?e.gameOver():e.shakeItem()}}};this.gameTaskCom.showTaskList(i)},o.prototype.initTaskComp=function(){var t=this;return new Promise(function(o,e){if(t.taskData){var i=cc.assetManager.getBundle("common");i?i.load("gameTask/gameTask",cc.Prefab,function(e,i){var n=cc.instantiate(i);t.gameTaskCom=n.getComponent("gameTask"),t.gameTaskCom&&t.gameTaskCom.initData(t.taskData),n.parent=t.node,o()}):e("common bundle nil!")}else e("task data nil!")}).catch(function(t){cc.error("initTaskComp error: "+t)})},o.prototype.testgame2=function(){this.cur_index=4,this.boxNode.active=!1,this.lightNode.active=!1,this.itemBoard.active=!1,this.showAllPainting()},o.prototype.onDestroy=function(){s.default.off(c.LIFE_CYCLE_BLOCK,this.onBlock,this),s.default.off(c.LIFE_CYCLE_UNBLOCK,this.unBlock,this)},o.prototype.dolphineAinback=function(t){var o=this,e=t;if("tiaoyue"===e.animation.name)this.playSpine(this.dolphineAin,"daiji",!0);else if("daiji"===e.animation.name){var i=this.bgSp.node.getChildByName("haitunNode");cc.tween(i).to(2,{opacity:0}).call(function(){i.destroy(),o.nextFollowStep()}).start()}},o.prototype.assembleItem=function(t){void 0===t&&(t=1),this.boxNode.getComponent("pdragItem").initItem(this.cur_index),this.paintSp.node.active=!1,this.boardSp.spriteFrame=this.boardSpArr[this.cur_index];for(var o=0;o<t;o++){var e=cc.instantiate(this.kongItem);e.getComponent("kongItem").initItem(o,this.cur_index,this),this.itemBoard.addChild(e)}},o.prototype.guideColorBox=function(){cc.tween(this.boxNode).by(.2,{scale:.1}).by(.2,{scale:-.1}).union().repeat(2).start()},o.prototype.splashColorAni=function(){this.setBlock(!0),this.itemBoard.getChildByName("kongItem").getComponent("kongItem").splashColor()},o.prototype.showPaintSp=function(){a.default.playEffect("paintingColor","audio/"+this.sounds_arr[this.cur_index]),this.paintSp.node.active=!0,this.paintSp.spriteFrame=this.paintSpArr[this.cur_index]},o.prototype.roundEnd=function(){var t=this;this.lightNode.active=!0,a.default.playEffect("paintingColor","audio/grate"),this.scheduleOnce(function(){return t.nextRound()},3)},o.prototype.nextRound=function(){if(this.lightNode.active=!1,this.cur_index++,this.cur_index>=4)return cc.log("game one end"),this.itemBoard.active=!1,void this.showAllPainting();this.assembleItem(1)},o.prototype.showAllPainting=function(){var t=this;this.showNode.active=!0,this.showNode.opacity=0,cc.tween(this.showNode).to(.5,{opacity:255}).start(),this.scheduleOnce(function(){return t.myShowTaskFun(0,!0)},2)},o.prototype.showGameTow=function(){var t=this;this.showNode.getComponent(cc.Sprite).spriteFrame=null,this.bgSp.spriteFrame=this.bgSpArr[0],cc.tween(this.showNode).by(1,{y:-200}).call(function(){t.bgSp.node.getChildByName("kuang").active=!0,t.myShowTaskFun(1,!1)}).start()},o.prototype.shakeItem=function(){for(var t=this,o=0,e=this.showNode.children;o<e.length;o++){var i=e[o];cc.tween(i).by(.1,{angle:10}).by(.1,{angle:-10}).by(.1,{angle:-10}).by(.1,{angle:10}).union().repeat(2).call(function(){t.playFollowEff()}).start()}},o.prototype.playFollowEff=function(){var t=this;s.default.emit(c.FOLLOW_CLIENT_TO_MODULE,{eventName:"display"}),a.default.playEffect("paintingColor","audio/blue",function(){return t.gameRunRecord()})},o.prototype.nextFollowStep=function(){if(this.cur_index++,this.cur_index>=6)return cc.log("game all end"),void this.myShowTaskFun(1,!0);this.shakeItem()},o.prototype.gameRunRecord=function(){cc.log("gameRunRecord~~~");var t={evaluatingType:1,evaluatingText:this.gameWordData[0],tryTimes:2,evaluationScore:30,recordTime:3};s.default.emit(c.FOLLOW_CLIENT_TO_MODULE,{eventName:"initComponent",extra:t});var o={evaluatingText:this.gameWordData[0],bundleName:"paintingColor",audioUrl:"audio/blue"};s.default.emit(c.FOLLOW_CLIENT_TO_MODULE,{eventName:"startRecord",extra:o})},o.prototype.recordResult=function(t){console.log("recordResult"+t.data),"ResultCb"==t.data.eventName&&(t.data.extra.score,t.data.success?this.sayRight():this.sayWrong())},o.prototype.sayRight=function(){this.moveToCenterAin(!0)},o.prototype.sayWrong=function(){this.moveToCenterAin(!1)},o.prototype.moveToCenterAin=function(t){var o=this,e=null;4==this.cur_index?e=this.showNode.getChildByName("dolphine_show"):5==this.cur_index&&(e=this.showNode.getChildByName("yingwu_show"));var i=this.bgSp.node.getChildByName("kuang").position,n=this.bgSp.node.convertToWorldSpaceAR(i),r=e.parent.convertToNodeSpaceAR(n);cc.tween(e).to(1,{position:r}).call(function(){o.fachen.node.position=r,o.fachen.node.y-=300,o.fachen.node.active=!0,o.playSpine(o.fachen,"Lanse",!1),t?o.disappearNode(e,!0):o.scheduleOnce(function(){e.angle=-20,o.heiyanAin.node.active=!0,o.playSpine(o.heiyanAin,"animation",!1),o.disappearNode(e,!1)},1)}).start()},o.prototype.disappearNode=function(t,o){var e=this;cc.tween(t).to(1,{opacity:0}).call(function(){if(t.destroy(),o){if(4==e.cur_index)e.bgSp.node.getChildByName("haitunNode").active=!0;else if(5==e.cur_index){var i=e.bgSp.node.getChildByName("yingwuNode");i.active=!0;var n=i.getChildByName("niao-fei");cc.tween(n).to(3,{position:cc.v3(136,-156,0)}).call(function(){n.destroy(),i.getChildByName("niao").active=!0,cc.tween(i).delay(2).to(2,{opacity:0}).call(function(){i.destroy(),e.nextFollowStep()}).start()}).start()}}else e.nextFollowStep()}).start()},o.prototype.setBlock=function(t){this.blockNode.active=t,t||this.guideColorBox()},o.prototype.playSpine=function(t,o,e){t.clearTracks(),t.setToSetupPose(),t.setAnimation(0,o,e)},o.prototype.gameOver=function(){cc.log("\u901a\u77e5\u5bb9\u5668 \u6e38\u620f\u7ed3\u675f"),s.default.off(c.FOLLOW_MODULE_TO_CLIENT,this.recordResult,this),this.overTag&&(this.overTag=!1,s.default.emit(c.LIFE_CYCLE_COMPLETE))},o.prototype.onBlock=function(){console.log("game blocked"),cc.audioEngine.pauseMusic(),cc.audioEngine.pauseAllEffects()},o.prototype.unBlock=function(){console.log("game unblocked"),cc.audioEngine.resumeMusic(),cc.audioEngine.resumeAllEffects()},r([u(cc.Sprite)],o.prototype,"paintSp",void 0),r([u(cc.SpriteFrame)],o.prototype,"paintSpArr",void 0),r([u(cc.Sprite)],o.prototype,"boardSp",void 0),r([u(cc.SpriteFrame)],o.prototype,"boardSpArr",void 0),r([u(cc.Prefab)],o.prototype,"kongItem",void 0),r([u(cc.Node)],o.prototype,"itemBoard",void 0),r([u(cc.Node)],o.prototype,"lightNode",void 0),r([u(cc.Node)],o.prototype,"boxNode",void 0),r([u(cc.Node)],o.prototype,"showNode",void 0),r([u(cc.Sprite)],o.prototype,"bgSp",void 0),r([u(cc.SpriteFrame)],o.prototype,"bgSpArr",void 0),r([u(sp.Skeleton)],o.prototype,"fachen",void 0),r([u(sp.Skeleton)],o.prototype,"dolphineAin",void 0),r([u(sp.Skeleton)],o.prototype,"heiyanAin",void 0),r([u(cc.Node)],o.prototype,"blockNode",void 0),r([d],o)}(cc.Component);e.default=h,cc._RF.pop()},{"../../../kit/events/events":void 0,"../../../kit/system/audio/AudioManager":void 0,"../../../kit/system/event/EventSystem":void 0}],pdragItem:[function(t,o,e){"use strict";cc._RF.push(o,"5b54eoOTZ1DfJLXPH0wdAmt","pdragItem");var i,n=this&&this.__extends||(i=function(t,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}i(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}),r=this&&this.__decorate||function(t,o,e,i){var n,r=arguments.length,c=r<3?o:null===i?i=Object.getOwnPropertyDescriptor(o,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(o,e,c):n(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});var c=t("../../../kit/system/audio/AudioManager"),a=t("../scr/paintingColor"),s=cc._decorator,p=s.ccclass,d=s.property,u=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.checkBox=null,o.colorBoxArr=[],o.mainCom=null,o.curNode=null,o.isCanMove=!0,o.mround=0,o.PosiArr=[cc.v3(-13,-140,0),cc.v3(-167,-140,0),cc.v3(13,-30,0),cc.v3(-127,-30,0)],o.sounds_arr=["blue","red","yel","blue"],o}return n(o,t),o.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},o.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},o.prototype.initItem=function(t){this.mround=t,this.curNode=this.colorBoxArr[this.mround],this.setCanTouch(!0)},o.prototype.start=function(){},o.prototype.touchStart=function(){this.isCanMove&&c.default.playEffect("paintingColor","audio/"+this.sounds_arr[this.mround])},o.prototype.touchEnd=function(){var t=this;if(this.isCanMove){this.setCanTouch(!1);var o=cc.v2(this.curNode.position.x,this.curNode.position.y);this.checkBox.getBoundingBox().contains(o)?(cc.log("into check box === "),this.curNode.active=!1,this.mainCom.splashColorAni()):(cc.tween(this.curNode).to(.2,{position:this.PosiArr[this.mround]}).start(),this.scheduleOnce(function(){t.setCanTouch(!0)},.5))}},o.prototype.onTouchMove=function(t){if(this.isCanMove){var o=t.getLocation(),e=this.node.convertToNodeSpaceAR(o);e.x>-200&&e.x<200&&(this.curNode.x=e.x),e.y>-200&&e.y<200&&(this.curNode.y=e.y)}},o.prototype.setCanTouch=function(t){this.isCanMove=t},r([d(cc.Node)],o.prototype,"checkBox",void 0),r([d(cc.Node)],o.prototype,"colorBoxArr",void 0),r([d(a.default)],o.prototype,"mainCom",void 0),r([p],o)}(cc.Component);e.default=u,cc._RF.pop()},{"../../../kit/system/audio/AudioManager":void 0,"../scr/paintingColor":"paintingColor"}]},{},["kongItem","paintingColor","pdragItem"]);