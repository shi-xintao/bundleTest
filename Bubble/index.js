window.__require=function t(e,o,n){function i(s,r){if(!o[s]){if(!e[s]){var a=s.split("/");if(a=a[a.length-1],!e[a]){var p="function"==typeof __require&&__require;if(!r&&p)return p(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var l=o[s]={exports:{}};e[s][0].call(l.exports,function(t){return i(e[s][1][t]||t)},l,l.exports,t,e,o,n)}return o[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({ActionHelper:[function(t,e,o){"use strict";cc._RF.push(e,"c68df4LW0BD1YbL4wyGrpog","ActionHelper"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.moveTo=function(e,o,n,i){void 0===n&&(n=1),void 0===i&&(i=function(){}),t.moveToXY(e,o.x,o.y,n,i)},t.moveToV2=function(e,o,n,i){void 0===n&&(n=1),void 0===i&&(i=function(){}),t.moveToXY(e,o.x,o.y,n,i)},t.moveToXY=function(t,e,o,n,i){void 0===n&&(n=1),void 0===i&&(i=function(){});var c=cc.moveTo(n,e,o).easing(cc.easeSineOut()),s=cc.sequence(c,cc.callFunc(function(){i()}));t.runAction(s)},t.fadeOut=function(t,e,o){void 0===e&&(e=1),void 0===o&&(o=function(){});var n=cc.fadeOut(e).easing(cc.easeSineOut()),i=cc.sequence(n,cc.callFunc(function(){o()}));t.runAction(i)},t.fadeIn=function(t,e,o){void 0===e&&(e=1),void 0===o&&(o=function(){});var n=cc.fadeIn(e).easing(cc.easeSineOut()),i=cc.sequence(n,cc.callFunc(function(){o()}));t.runAction(i)},t}();o.default=n,cc._RF.pop()},{}],Balloon2:[function(t,e,o){"use strict";cc._RF.push(e,"7d0a678hpdBjbz0s4nx6G/k","Balloon2");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./ActionHelper"),r=cc._decorator,a=r.ccclass,p=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shape=null,e.origin=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.showShape=function(){this.shape.active=!0,this.origin.active=!0,this.shape.opacity=0,this.origin.opacity=255,s.default.fadeIn(this.shape,.5),s.default.fadeOut(this.origin,.5)},e.prototype.showOrigin=function(){this.shape.active=!0,this.origin.active=!0,this.shape.opacity=255,this.origin.opacity=0,s.default.fadeOut(this.shape,.5),s.default.fadeIn(this.origin,.5)},c([p(cc.Node)],e.prototype,"shape",void 0),c([p(cc.Node)],e.prototype,"origin",void 0),c([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./ActionHelper":"ActionHelper"}],Balloon:[function(t,e,o){"use strict";cc._RF.push(e,"a7a7aXG0XdJzam7sOSOwZvu","Balloon");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../kit/system/audio/AudioManager"),r=t("./Bubble"),a=t("./states/TheThreeState"),p=cc._decorator,l=p.ccclass,u=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blink=null,e.empty=null,e.index=0,e.touchEndFunc=null,e.touchBeganFunc=null,e.hotArea=null,e.hotBg=null,e.state=o.STATE_EMPTY,e.context=null,e.flag_block=!1,e.full_btn=null,e.initPos=cc.Vec2.ZERO,e.currPos=cc.Vec2.ZERO,e.guiding=!1,e.flagChangeAnim=!1,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.hotArea=cc.find("pump_mouse",this.node.parent),this.hotBg=cc.find("bg",this.hotArea),this.context=this.node.parent.parent.parent.getComponent(r.default),this.full_btn=cc.find("full_btn",this.node)},e.prototype.onFullClicked=function(){var t=this;this.state==o.STATE_TO_CLICK&&(this.context.hand.hide(),this.context.unScheduleGuideFinish(),this.context.playVoice(),this.state=o.STATE_FLY_FRAME,s.default.playEffect("Bubble","sound/SE_QQyouleyuan02"),this.moveTo(this.context.step1.poses_fly[this.index],1,function(){if(s.default.playEffect("Bubble","sound/SE_QQyouleyuan03"),t.state=o.STATE_FINISH,r.default.instance.currBalloonId=-1,t.playNormal(),t.context.isAllFinished())t.context.taskBoard.show(0,function(){t.context.taskBoard.playFinished(),t.context.scheduleOnce(function(){t.context.taskBoard.hide();var e=new a.default(t.context);t.context.setState(e)},3)});else{var e=t.context.getCurrState();"BoardState"==e.id&&e.onGuideFinish()}}))},e.prototype.onTouchBegan=function(){this.state!=o.STATE_FINISH&&(this.flag_block||r.default.instance.currBalloonId!=this.index&&-1!=r.default.instance.currBalloonId||(r.default.instance.currBalloonId=this.index,this.context.hand.hide(),this.context.unScheduleGuideFinish(),this.context.playVoice(),this.currPos.x=this.node.x,this.currPos.y=this.node.y,this.initPos.x=this.node.x,this.initPos.y=this.node.y))},e.prototype.onTouchMove=function(t){if(this.state!=o.STATE_FINISH&&!this.flag_block&&r.default.instance.currBalloonId==this.index){var e=t.getDeltaX(),n=t.getDeltaY();this.currPos.x+=e,this.currPos.y+=n,this.node.x=this.currPos.x,this.node.y=this.currPos.y;var i=this.node.parent.convertToWorldSpaceAR(this.node.position);this.hotArea.getBoundingBoxToWorld().contains(cc.v2(i.x,i.y))?this.hotBg.active=!0:this.hotBg.active=!1}},e.prototype.onTouchEnd=function(t){var e=this;if(this.state!=o.STATE_FINISH&&!this.flag_block&&r.default.instance.currBalloonId==this.index){var n=t.getLocationX(),i=t.getLocationY();if(Math.sqrt((n-this.initPos.x)*(n-this.initPos.x)+(i-this.initPos.y)*(i-this.initPos.y))>20){var c=this.node.parent.convertToWorldSpaceAR(this.node.position);this.hotArea.getBoundingBoxToWorld().contains(cc.v2(c.x,c.y))?this.hotBg.active=!0:this.hotBg.active=!1,this.hotBg.active?this.state==o.STATE_EMPTY&&(this.state=o.STATE_PUMP,this.hotBg.active=!1,this.context.playVoice(),this.moveTo(this.context.step1.mouth,.5,function(){e.state=o.STATE_PUMP,e.playPump(function(){e.state=o.STATE_FLY_CENTER,s.default.playEffect("Bubble","sound/SE_QQyouleyuan02"),e.moveTo(e.context.step1.center,1,function(){s.default.playEffect("Bubble","sound/SE_QQyouleyuan03"),e.state=o.STATE_TO_CLICK,e.flag_block=!0,e.playBlink(),e.onGuideFinish()})})})):this.moveTo(this.context.step1.poses_init[this.index],.2,function(){r.default.instance.currBalloonId=-1})}}},e.prototype.guideClickBallon=function(){var t=this;if(!this.guiding){var e=0;this.context.hand.onCompleted=function(){0==e?(e++,t.context.hand.playClick()):(t.guiding=!1,t.context.hand.hide(),t.onGuideFinish())},this.guiding=!0,this.context.hand.setTargetNode(this.full_btn,this.context.node),this.context.hand.playClick()}},e.prototype.onGuideFinish=function(){var t=this;this.context.clickGuideTimer.start(5,function(){t.guideClickBallon()})},e.prototype.start=function(){},e.prototype.playPump=function(t){var e=this;s.default.playEffect("Bubble","sound/SE_QQyouleyuan01"),this.empty.setAnimation(0,"normal",!1),this.context.step1.smoke.node.active=!0,this.context.step1.smoke.front.setAnimation(0,"animation",!0),this.empty.setCompleteListener(function(){console.log("completed >>>>>"),e.blink.node.active=!0,e.context.step1.smoke.node.active=!1,e.playNormal(),e.empty.node.active=!1,t&&t()}),this.empty.setEndListener(function(){})},e.prototype.playNormal=function(){this.blink.setAnimation(0,"normal",!0)},e.prototype.playBlink=function(){this.blink.setAnimation(0,"blink",!0)},e.prototype.moveTo=function(t,e,o){var n=this;void 0===e&&(e=1),void 0===o&&(o=function(){}),this.flag_block=!0;var i=cc.moveTo(e,t.x,t.y),c=cc.sequence(i,cc.callFunc(function(){n.flag_block=!1,o()}));this.node.runAction(c)},e.STATE_EMPTY=0,e.STATE_PUMP=1,e.STATE_FLY_CENTER=2,e.STATE_TO_CLICK=3,e.STATE_FLY_FRAME=4,e.STATE_FINISH=5,c([u({type:sp.Skeleton,displayName:"\u9971\u6c14\u7403\u52a8\u753b"})],e.prototype,"blink",void 0),c([u({type:sp.Skeleton,displayName:"\u7a7a\u6c14\u7403\u52a8\u753b"})],e.prototype,"empty",void 0),c([u({type:cc.Integer,displayName:"\u5e8f\u53f7"})],e.prototype,"index",void 0),o=c([l],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../kit/system/audio/AudioManager":void 0,"./Bubble":"Bubble","./states/TheThreeState":"TheThreeState"}],BoardState:[function(t,e,o){"use strict";cc._RF.push(e,"df723AXbuNJ2aRPJMB3OH8w","BoardState");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Balloon"),s=function(t){function e(e){var o=t.call(this,e)||this;return o.id="BoardState",o.taskBoard=null,o.hand=null,o}return i(e,t),e.prototype.init=function(){this.taskBoard=this.context.taskBoard,this.hand=this.context.hand},e.prototype.exec=function(){var t=this;this.taskBoard.show(0,function(e){e||t.guidePumpBallon()}),this.context.pumpGuideTimer.start(e.SHOW_TASK_TIME,function(){t.taskBoard.isShowing&&t.taskBoard.hide(),t.guidePumpBallon()})},e.prototype.guidePumpBallon=function(){var t=this;if(!this.context.hand.isShowing&&!this.context.isAllFinished()){var e=this.context.getCurrGuideIndex();if(-1!=e){var o=45;1==e?o=30:2==e&&(o=15);var n=this.context.step1.balloons[e];if(n.state==c.default.STATE_EMPTY){var i=this.context.emptyFrames[e];this.hand.setTargetNode(i,this.context.node);var s=1,r=0;this.context.hand.onCompleted=function(){0==s?(s=1,t.context.hand.playSwipeByAngle(o,"you-zuo",!1)):1==s&&(0==r?(r++,t.context.hand.playSwipeByAngle(o,"you-zuo",!1)):(t.context.hand.hide(),t.onGuideFinish()))},this.context.hand.playSwipeByAngle(o,"you-zuo",!1)}else n.guideClickBallon()}}},e.prototype.onGuideFinish=function(){var t=this;this.context.pumpGuideTimer.start(5,function(){t.guidePumpBallon()})},e.prototype.onFinished=function(){},e.SHOW_TASK_TIME=4,e}(t("../GState").default);o.default=s,cc._RF.pop()},{"../Balloon":"Balloon","../GState":"GState"}],BubbleStep1:[function(t,e,o){"use strict";cc._RF.push(e,"386ddIDuNpAmbDyGZy4fEmg","BubbleStep1");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Balloon"),r=t("./Role"),a=cc._decorator,p=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shapes=[],e.balloons=[],e.poses_fly=[],e.poses_init=[],e.pump=null,e.pump_mouse=null,e.board=null,e.center=null,e.mouth=null,e.smoke=null,e}return i(e,t),e.prototype.start=function(){},c([l({type:[cc.Node],displayName:"\u6c14\u7403\u6846"})],e.prototype,"shapes",void 0),c([l({type:[s.default],displayName:"\u6c14\u7403"})],e.prototype,"balloons",void 0),c([l({type:[cc.Node],displayName:"\u6c14\u7403\u653e\u98de\u4f4d\u7f6e"})],e.prototype,"poses_fly",void 0),c([l({type:[cc.Node],displayName:"\u6c14\u7403\u521d\u59cb\u4f4d\u7f6e"})],e.prototype,"poses_init",void 0),c([l({type:cc.Node,displayName:"\u6c14\u7b52"})],e.prototype,"pump",void 0),c([l({type:cc.Node,displayName:"\u6c14\u7b52\u5634"})],e.prototype,"pump_mouse",void 0),c([l({type:cc.Node,displayName:"\u9898\u677f"})],e.prototype,"board",void 0),c([l({type:cc.Node,displayName:"\u4e2d\u5fc3"})],e.prototype,"center",void 0),c([l({type:cc.Node,displayName:"\u6c14\u5634"})],e.prototype,"mouth",void 0),c([l({type:r.default,displayName:"\u70df\u6c14"})],e.prototype,"smoke",void 0),c([p],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Balloon":"Balloon","./Role":"Role"}],BubbleStep2:[function(t,e,o){"use strict";cc._RF.push(e,"1af603M821Af7bkKA7fozUH","BubbleStep2");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Balloon2"),r=t("./Role"),a=cc._decorator,p=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.poses_final=[],e.pos_init=null,e.roles=[],e.smoke=null,e.balls=[],e._currIndex=0,e}return i(e,t),Object.defineProperty(e.prototype,"roleList",{get:function(){return this.roles},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currRole",{get:function(){return this.roles[this._currIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currBall",{get:function(){return this.balls[this._currIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPos",{get:function(){return this.poses_final[this._currIndex]},enumerable:!1,configurable:!0}),e.prototype.next=function(){this._currIndex++},Object.defineProperty(e.prototype,"currIndex",{get:function(){return this._currIndex},enumerable:!1,configurable:!0}),e.prototype.start=function(){},c([l({type:[cc.Node],displayName:"\u6700\u7ec8\u4f4d\u7f6e"})],e.prototype,"poses_final",void 0),c([l({type:cc.Node,displayName:"\u8d77\u59cb\u4f4d\u7f6e"})],e.prototype,"pos_init",void 0),c([l({type:[r.default],displayName:"\u89d2\u8272"})],e.prototype,"roles",void 0),c([l({type:r.default,displayName:"\u70df\u96fe"})],e.prototype,"smoke",void 0),c([l({type:[s.default],displayName:"\u4e09\u8272\u957f\u7403"})],e.prototype,"balls",void 0),c([p],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Balloon2":"Balloon2","./Role":"Role"}],Bubble:[function(t,e,o){"use strict";cc._RF.push(e,"d35f4yGoNlIVJTViMeUfCQ/","Bubble");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../common/gameTask/scripts/TaskBoard"),a=t("../../../common/hand/Hand"),p=t("../../../common/scripts/ChapterGameComponent"),l=t("../../../kit/events/events"),u=t("../../../kit/system/event/EventSystem"),h=t("./Balloon"),d=t("./BubbleStep1"),f=t("./BubbleStep2"),y=t("./states/ZoomState"),g=t("./Timer"),_=cc._decorator,v=_.ccclass,b=_.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shopSize=cc.Size.ZERO,e.shopPos=cc.Vec2.ZERO,e.bg=null,e.handPrefab=null,e.hand=null,e.step1=null,e.step2=null,e.taskNodes=[],e.taskBoard=null,e.taskBoardPrefab=null,e.tip=null,e.currBalloonId=-1,e.emptyFrames=[],e.MUSIC_PATH="audio/",e.BUNDLE_NAME="Bubble",e.VOICE_TEXT_BALLOON="\u6c14\u7403",e.currState=null,e.pumpGuideTimer=null,e.clickGuideTimer=null,e.recording=!1,e.currBgSize=cc.Size.ZERO,e.guideCallback=null,e.guideCallback2=null,e}var o;return i(e,t),o=e,e.prototype.getCurrState=function(){return this.currState},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.fixBg(),o.instance=this;var e=cc.instantiate(this.taskBoardPrefab);this.node.addChild(e),this.taskBoard=e.getComponent(r.default);for(var n=0;n<this.taskNodes.length;n++)(s=this.taskNodes[n]).active=!1;this.taskBoard.setNodes(this.taskNodes),this.taskBoard.node.active=!1,this.step1.node.active=!0,this.step2.node.active=!1;var i=cc.instantiate(this.handPrefab);i.active=!1,this.node.addChild(i),this.hand=i.getComponent(a.default),this.hand.onCompleted=this.onHandCompleted.bind(this),this.pumpGuideTimer=new g.default,this.pumpGuideTimer.name="pumpGuideTimer",this.clickGuideTimer=new g.default,this.clickGuideTimer.name="clickGuideTimer";var c=-281.688*this.bg.height/750;for(n=0;n<this.step2.poses_final.length;n++)(s=this.step2.poses_final[n]).y=c;for(this.step2.pos_init.y=c,n=0;n<this.step2.roleList.length;n++){var s;(s=this.step2.roleList[n]).node.x=this.step2.pos_init.x,s.node.y=this.step2.pos_init.y,s.playSide()}this.playVoice("\u80cc\u666f\u97f3")},e.prototype.onRecordResult=function(e){this.recording=!1,t.prototype.onRecordResult.call(this,e),this.currState.onRecordResult(e)},e.prototype.evaluate=function(){this.recording||(this.recording=!0,this.startRecordAudio(this.VOICE_TEXT_BALLOON))},e.prototype.initData=function(){t.prototype.initData.call(this),this.taskData={bundleName:"Bubble",imgList:[]}},e.prototype.start=function(){var t=new y.default(this);this.setState(t)},e.prototype.setState=function(t){this.currState&&this.currState.id==t.id||(this.currState=t,t.init(),t.exec())},e.prototype.fixBg=function(){var t=cc.view.getFrameSize(),e=cc.Canvas.instance.designResolution,o=cc.size(e.width,e.height),n=t.width/t.height,i=c({},o);if(this.bg.width/this.bg.height>n){var s=this.bg.width*i.height/this.bg.height;this.bg.width=s,this.bg.height=i.height}else{var r=this.bg.height*i.width/this.bg.width;this.bg.width=i.width,this.bg.height=r}this.bg.x=0,this.bg.y=0,this.currBgSize.width=this.bg.width,this.currBgSize.height=this.bg.height},e.prototype.onClick=function(){},e.prototype.getCurrGuideIndex=function(){for(var t=-1,e=0;e<this.step1.balloons.length;e++)if(this.step1.balloons[e].state!=h.default.STATE_FINISH){t=e;break}return t},e.prototype.isAllFinished=function(){for(var t=!0,e=0;e<this.step1.balloons.length;e++)if(this.step1.balloons[e].state!=h.default.STATE_FINISH){t=!1;break}return t},e.prototype.unScheduleGuideFinish=function(){this.pumpGuideTimer.stop(),this.clickGuideTimer.stop()},e.prototype.playVoice=function(t){void 0===t&&(t="\u6c14\u7403")},e.prototype.playStars=function(){u.default.emit(l.LIFE_CYCLE_COMPLETE)},e.prototype.showTip=function(t){this.tip.string=t;var e=cc.fadeIn(.5).easing(cc.easeSineOut()),o=cc.fadeOut(.3).easing(cc.easeSineOut()),n=cc.sequence(e,cc.delayTime(2),o);this.tip.node.runAction(n)},e.prototype.onHandCompleted=function(){},e.prototype.showHand=function(t){this.hand.setTargetNode(t,this.node),this.hand.node.active=!0},e.prototype.update=function(t){this.pumpGuideTimer.update(t),this.clickGuideTimer.update(t)},e.RABBIT_INDEX=2,e.instance=null,s([b({displayName:"\u5546\u5e97\u56fe\u7247\u5bbd\u9ad8"})],e.prototype,"shopSize",void 0),s([b({displayName:"\u5546\u5e97(left|bottom)"})],e.prototype,"shopPos",void 0),s([b({type:cc.Node,displayName:"\u80cc\u666f\u56fe"})],e.prototype,"bg",void 0),s([b({type:cc.Prefab,displayName:"\u5f15\u5bfc\u624b"})],e.prototype,"handPrefab",void 0),s([b({type:d.default,displayName:"step1"})],e.prototype,"step1",void 0),s([b({type:f.default,displayName:"step2"})],e.prototype,"step2",void 0),s([b({type:[cc.Node],displayName:"\u4efb\u52a1\u6846\u5185\u5bb9"})],e.prototype,"taskNodes",void 0),s([b({type:cc.Prefab,displayName:"\u4efb\u52a1\u6846prefab"})],e.prototype,"taskBoardPrefab",void 0),s([b({type:cc.Label,displayName:"tip"})],e.prototype,"tip",void 0),s([b({type:[cc.Node],displayName:"\u762a\u6c14\u7403\u6846"})],e.prototype,"emptyFrames",void 0),o=s([v],e)}(p.default);o.default=m,cc._RF.pop()},{"../../../common/gameTask/scripts/TaskBoard":void 0,"../../../common/hand/Hand":void 0,"../../../common/scripts/ChapterGameComponent":void 0,"../../../kit/events/events":void 0,"../../../kit/system/event/EventSystem":void 0,"./Balloon":"Balloon","./BubbleStep1":"BubbleStep1","./BubbleStep2":"BubbleStep2","./Timer":"Timer","./states/ZoomState":"ZoomState"}],GState:[function(t,e,o){"use strict";cc._RF.push(e,"3c309O18SlMuYcnNypc3Qf+","GState"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t){this.context=null,this.id="",this.context=t}return t.prototype.init=function(){},t.prototype.exec=function(){},t.prototype.onFinished=function(){},t}();o.default=n,cc._RF.pop()},{}],Role:[function(t,e,o){"use strict";cc._RF.push(e,"61906DV8+dEopD1eEyyZPMe","Role");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../kit/system/audio/AudioManager"),r=t("./ActionHelper"),a=cc._decorator,p=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.side=null,e.front=null,e.bg=null,e.balloon=null,e.balloon2=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.playSide=function(){this.side.node.active=!0,this.front.node.active=!1,this.side.setAnimation(0,"walk",!0)},e.prototype.playStandby=function(){this.side.node.active=!1,this.front.node.active=!0,this.front.setAnimation(0,"standby",!0)},e.prototype.playHope=function(){s.default.playEffect("Bubble","sound/SE_QQyouleyuan05"),this.side.node.active=!1,this.front.node.active=!0,this.front.setAnimation(0,"hope",!0)},e.prototype.playCry=function(){this.side.node.active=!1,this.front.node.active=!0,this.front.setAnimation(0,"cry",!0)},e.prototype.playHappy=function(){this.side.node.active=!1,this.front.node.active=!0,this.front.setAnimation(0,"happy",!0)},e.prototype.showBalloon=function(){this.balloon.active=!0,r.default.fadeIn(this.balloon,.2)},e.prototype.showBalloon2=function(){this.balloon2.active=!0},e.prototype.walkTo=function(t,e){var o=this;s.default.playEffect("Bubble","sound/SE_QQyouleyuan04"),Math.abs(t.x-this.node.x)>5&&(t.x>this.node.x&&(this.node.scaleX=-1),this.playSide()),r.default.moveTo(this.node,t,3,function(){o.node.scaleX=1,o.playStandby(),e()})},c([l({type:sp.Skeleton,displayName:"\u4fa7\u9762\u52a8\u753b"})],e.prototype,"side",void 0),c([l({type:sp.Skeleton,displayName:"\u6b63\u9762\u52a8\u753b"})],e.prototype,"front",void 0),c([l({type:cc.Node,displayName:"\u53c2\u8003\u70b9"})],e.prototype,"bg",void 0),c([l({type:cc.Node,displayName:"\u624b\u6301\u6c14\u7403"})],e.prototype,"balloon",void 0),c([l({type:cc.Node,displayName:"\u624b\u6301\u6c14\u7403\u4fa7\u9762"})],e.prototype,"balloon2",void 0),c([p],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../kit/system/audio/AudioManager":void 0,"./ActionHelper":"ActionHelper"}],SpineList:[function(t,e,o){"use strict";cc._RF.push(e,"e72008ZK+FOSLh4R7x73a+c","SpineList");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,a=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){},c([r],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],TheThreeState:[function(t,e,o){"use strict";cc._RF.push(e,"82791ILv3xLOrMqzWFErVJo","TheThreeState");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../../kit/system/audio/AudioManager"),s=t("../ActionHelper"),r=t("../Bubble"),a=t("../GState"),p=t("../ToFloatEx"),l=function(t){function e(e){var o=t.call(this,e)||this;return o.id="ZoomState",o.tofloat=null,o.shopSize=cc.Size.ZERO,o.shopPos=cc.Vec2.ZERO,o.currBgSize=cc.Size.ZERO,o.destBgSize=cc.Size.ZERO,o.currBgPos=cc.Vec2.ZERO,o.destBgPos=cc.Vec2.ZERO,o.bg=null,o.gameWordData=["\u6c14\u7403"],o.gameWordAudio=["balloon"],o}return i(e,t),e.prototype.init=function(){this.context.step1.node.active=!1,this.context.step2.node.active=!0,this.shopPos=this.context.shopPos,this.shopSize=this.context.shopSize,this.bg=this.context.bg;var t=this.bg.getComponent(p.default);t||(t=this.bg.addComponent(p.default)),this.tofloat=t,this.tofloat.onFinished=this.onZoomFinished.bind(this),this.destBgSize=cc.size(this.context.currBgSize.width,this.context.currBgSize.height),this.currBgSize=cc.size(this.bg.width,this.bg.height),this.currBgPos=cc.v2(this.bg.x,this.bg.y),this.destBgPos=cc.Vec2.ZERO},e.prototype.onZoomFinished=function(){var t=this;this.context.taskBoard.onClosed=function(){t.onGameBegan(),t.context.taskBoard.onClosed=null},this.context.taskBoard.show(1,function(e){e&&t.context.scheduleOnce(function(){t.context.taskBoard.hide()},6)})},e.prototype.zoomFromShop=function(){var t=this,e=Math.PI/2;this.tofloat.setData(1,0,1,function(o){var n=o*e,i=Math.sin(n);t.updateZoom(i)}),this.tofloat.run()},e.prototype.updateZoom=function(t){this.bg.width=(this.destBgSize.width-this.currBgSize.width)*t+this.currBgSize.width,this.bg.height=(this.destBgSize.height-this.currBgSize.height)*t+this.currBgSize.height,this.bg.x=(this.destBgPos.x-this.currBgPos.x)*t+this.currBgPos.x,this.bg.y=(this.destBgPos.y-this.currBgPos.y)*t+this.currBgPos.y},e.prototype.exec=function(){this.zoomFromShop()},e.prototype.onFinished=function(){var t=this;this.context.taskBoard.show(1,function(){t.context.taskBoard.playFinished(),t.context.scheduleOnce(function(){t.context.taskBoard.hide(),t.context.playVoice("\u6b22\u547c"),t.context.playStars()},2)})},e.prototype.onRecordResult=function(t){var e=this;if(t=t.data,console.log("onRecordResult >>>>>>>>>>>>> "+JSON.stringify(t)),t.eventName&&"ResultCb"==t.eventName){var o=this.context.step2.currRole;if(t.success){console.log("onRecordResult >>>>>>>>"),this.context.playVoice("\u592a\u68d2\u4e86"),o.playHappy(),this.context.step2.smoke.front.setCompleteListener(function(){o.playStandby(),n.node.active=!0,s.default.fadeOut(n.node,.2),o.showBalloon(),e.context.scheduleOnce(function(){e.context.step2.currIndex!=r.default.RABBIT_INDEX&&o.showBalloon2(),o.walkTo(e.context.step2.currPos,function(){e.context.step2.next(),e.context.step2.currIndex<=2?e.context.scheduleOnce(function(){e.onGameBegan()},1):e.onFinished()})},2)}),c.default.playEffect("Bubble","sound/SE_QQyouleyuan06"),this.context.step2.smoke.front.setAnimation(0,"bomb",!1);var n=this.context.step2.currBall;n.showShape()}else o.playCry(),this.context.scheduleOnce(function(){o.playHope(),e.context.scheduleOnce(function(){e.context.evaluate()},2)},3)}},e.prototype.onGameBegan=function(){var t=this;console.log("start game>>>>>>>>>");var e=this.context.step2.currRole;e.node.active=!0,e.playSide();var o=this.context.step2.currBall,n=this.context.step2.poses_final[r.default.RABBIT_INDEX];c.default.playEffect("Bubble","sound/SE_QQyouleyuan04"),s.default.moveToXY(e.node,n.position.x,e.node.y,3,function(){e.playHope(),c.default.playEffect("Bubble","sound/SE_QQyouleyuan07"),s.default.moveTo(o.node,t.context.step2.smoke.node,.5,function(){t.context.evaluate()})})},e}(a.default);o.default=l,cc._RF.pop()},{"../../../../kit/system/audio/AudioManager":void 0,"../ActionHelper":"ActionHelper","../Bubble":"Bubble","../GState":"GState","../ToFloatEx":"ToFloatEx"}],Timer:[function(t,e,o){"use strict";cc._RF.push(e,"584e1fJ7HdB24eJLPq7PQPW","Timer"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.callback=null,this.currTime=0,this.totalTime=0,this.running=!1,this.name=""}return t.prototype.update=function(t){this.running&&(this.currTime+=t,this.currTime>=this.totalTime&&(this.running=!1,console.log("timer: "+this.name+" finished>>>>>"),this.callback?(0,this.callback)():console.log(this.name+":callback is null")))},t.prototype.stop=function(){console.log("timer: "+this.name+" stopped>>>>>"),this.running=!1,this.totalTime=0,this.currTime=0},t.prototype.pause=function(){this.running=!1},t.prototype.resume=function(){this.running=!0},t.prototype.start=function(t,e){console.log("timer: "+this.name+" started"),this.totalTime=t,this.currTime=0,this.running=!0,this.callback=e},t}();o.default=n,cc._RF.pop()},{}],ToFloatEx:[function(t,e,o){"use strict";cc._RF.push(e,"0b86dL5rABM+pOfmSteerJa","ToFloatEx");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,c=arguments.length,s=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(s=(c<3?i(s):c>3?i(e,o,s):i(e,o))||s);return c>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,a=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toFloatFrom=0,e.toFloatTo=0,e.toFloatDuration=0,e.toFloatFlag=!1,e.toFloatCallback=null,e.toFloatCurrTime=0,e.onFinished=null,e}return i(e,t),e.prototype.setData=function(t,e,o,n){this.toFloatFlag&&(this.toFloatFlag=!1),this.toFloatFrom=e,this.toFloatTo=o,this.toFloatDuration=t,this.toFloatCallback=n},e.prototype.run=function(){this.toFloatCurrTime=0,this.toFloatFlag=!0},e.prototype.start=function(){},e.prototype.stop=function(){this.toFloatFlag=!1},e.prototype.onDestroy=function(){},e.prototype.update=function(t){if(this.toFloatFlag){this.toFloatCurrTime+=t;var e=this.toFloatCurrTime/this.toFloatDuration;e>1&&(e=1),this.toFloatCallback&&(0,this.toFloatCallback)(this.toFloatFrom+(this.toFloatTo-this.toFloatFrom)*e),e>=1&&(this.toFloatFlag=!1,this.onFinished&&(0,this.onFinished)())}},c([r],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],ZoomState:[function(t,e,o){"use strict";cc._RF.push(e,"c5d4erv3jZO5pkG5c9ihYyX","ZoomState");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var c=t("../GState"),s=t("../ToFloatEx"),r=t("./BoardState"),a=function(t){function e(e){var o=t.call(this,e)||this;return o.id="ZoomState",o.tofloat=null,o.shopSize=cc.Size.ZERO,o.shopPos=cc.Vec2.ZERO,o.currBgSize=cc.Size.ZERO,o.destBgSize=cc.Size.ZERO,o.currBgPos=cc.Vec2.ZERO,o.destBgPos=cc.Vec2.ZERO,o.bg=null,o}return i(e,t),e.prototype.init=function(){var t=this.context.step1.board;this.context.step1.node.active=!1,t.getComponent(cc.Widget).top=-t.height,this.shopPos=this.context.shopPos,this.shopSize=this.context.shopSize,this.bg=this.context.bg;var e=this.bg.addComponent(s.default);this.tofloat=e,this.tofloat.onFinished=this.onZoomFinished.bind(this)},e.prototype.zoomToShop=function(){var t,e,o=this,n=cc.Canvas.instance.designResolution,i=n.width,c=n.height,s=(this.bg.width,this.bg.height,this.shopSize.width),r=this.shopSize.height,a=1,p=1;s/r>n.width/n.height?p=(a=i)*r/s:a=(p=c)*s/r,t=1334*a/s,e=750*p/r;var l=this.shopPos.x,u=this.shopPos.y,h=t/2-(l*a/s+a/2),d=e/2-(u*p/r+p/2);console.log("dx:"+h+" dy:"+d),console.log("bgw:"+t+" bgh:"+e),console.log("raw left:"+l+" bottom:"+u),this.currBgSize=cc.size(this.bg.width,this.bg.height),this.destBgPos=cc.v2(h,d),this.destBgSize=cc.size(t,e);var f=Math.PI/2;this.tofloat.setData(1,0,1,function(t){var e=t*f,n=Math.sin(e);o.updateZoom(n)}),this.tofloat.run()},e.prototype.updateZoom=function(t){this.bg.width=(this.destBgSize.width-this.currBgSize.width)*t+this.currBgSize.width,this.bg.height=(this.destBgSize.height-this.currBgSize.height)*t+this.currBgSize.height,this.bg.x=(this.destBgPos.x-this.currBgPos.x)*t+this.currBgPos.x,this.bg.y=(this.destBgPos.y-this.currBgPos.y)*t+this.currBgPos.y},e.prototype.onZoomFinished=function(){var t=this;this.context.scheduleOnce(function(){var e=t.context.step1.board;t.context.step1.node.active=!0;var o=e.height,n=cc.moveBy(.4,0,-o).easing(cc.easeSineOut()),i=cc.sequence(n,cc.callFunc(function(){t.onFinished()}));t.context.step1.board.runAction(i)},1)},e.prototype.exec=function(){var t=this;this.context.scheduleOnce(function(){t.zoomToShop()},1)},e.prototype.onFinished=function(){var t=new r.default(this.context);this.context.setState(t)},e}(c.default);o.default=a,cc._RF.pop()},{"../GState":"GState","../ToFloatEx":"ToFloatEx","./BoardState":"BoardState"}]},{},["ActionHelper","Balloon","Balloon2","Bubble","BubbleStep1","BubbleStep2","GState","Role","SpineList","Timer","ToFloatEx","BoardState","TheThreeState","ZoomState"]);