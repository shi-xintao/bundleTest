{"version":3,"sources":["assets/bundles/SweepLeaves/src/Constant.ts","assets/bundles/SweepLeaves/src/SweepLeaves.ts"],"names":["playSpineAnimation","spine","animation","loop","trackIndex","Promise","resolve","en","setAnimation","setTrackCompleteListener","then","exports","loadSpriteFrame","url","cc","resources","load","SpriteFrame","err","sprite","console","log","AudioManager_1","require","EventSystem_1","events_1","Constant_1","TimerSystem_1","ccclass","_decorator","DOG_SK","BROOM_SK","BUBBLE_SK","MUSIC_TYPE","SweepLeaves","_super","__extends","_this","apply","this","arguments","dogSk","bubbleSk","broomSk","starSk","leafContent","ballContent","guideNode","tigoHead","blockInputNode","taskNode","hideTaskBtn","gameAudioIndex","gameIndex","gameTaskIndex","isTaskShow","moveLen","taskHideTime","moveTime","bubble_skin","leafIndex","taskCallback","gameTotal","isClicking","gameWordData","gameWordAudio","gameReadIcon","MUSIC_PATH","BUNDLE_NAME","startRecordFunc","prototype","onLoad","default","on","FOLLOW_MODULE_TO_CLIENT","recordResult","start","initAllNode","initOnClickLeafNode","initOtherNodeMes","initTaskNodeMes","startRunGame","LIFE_CYCLE_BLOCK","block","LIFE_CYCLE_UNBLOCK","onBlock","palyBGM","showBlockNode","onDestroy","off","isValid","node","destroy","getSpineByNode","getChildByName","active","hideTigoHeadAnimation","showGuideNode","hideGuideNode","hideBlockNode","children","forEach","item","Node","EventType","TOUCH_END","e","onClickLeaf","push","target","name","targetItem","leafNode","getComponent","sp","Skeleton","playBroomAnimation","palyAudioByIdx","targetNode","tarPos","getPosition","setPosition","x","y","playEffect","LEAF_SAO","scheduleOnce","playBroomEndAnimation","tween","to","opacity","call","playAudioByName","nextGameLevel","length","palyDogHappyAnimation","showStarAnimation","palyDogExcitedAnimation","instance","doFrameOnce","__awaiter","showTaskList","_a","sent","showSealSpine","hideTaskList","hideSealSpine","hideStarAnimation","stopMusic","emit","LIFE_CYCLE_COMPLETE","palyDogIdleAnimation","initBubbleMes","showTigoHeadAnimation","gameRunRecord","bubbleName","tarBall","THROW_BALL","scaleX","scaleY","delay","isLoop","HAPPY","STAY","EXCITED","setDogBallAnimation","setSkin","clearTracks","setToSetupPose","palyDogBallRightAnimation","originPos","position","time","action1","RUN","scale","YAO_QIU","STAY_YAO_RUN","STAY_YAO_QIU","STAY_FANG_QIU","palyDogBallWrongAnimation","DOG_SAD","DOUBT","playMusic","BG_MUSIC","colorNum","Number","YELLOW","RED","di","posX","view","getFrameSize","width","content","id","bool","setTaskCallBack","by","cancelTaskCallBack","unschedule","nodeName","warn","targetSk","SAD","SHOW","IDLE","HIDE","showBubbleSpine","sealNode","sk","SEAL","onClickTaskBtn","recordData","evaluatingType","evaluatingText","tryTimes","evaluationScore","recordTime","FOLLOW_CLIENT_TO_MODULE","eventName","extra","startRecordData","bundleName","audioUrl","iconPath","result","data","success","START","SO_GOOD","kEEP_TRYING","COOL","PREFECT","GONG_XI","playSpineByName","startSp","endSp","setEndListener","addAnimation","__decorate","Component"],"mappings":"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","sourcesContent":["/**\n * 播放一次骨骼动画，支持await\n * @param spine\n * @param animation 动画名字\n * @param loop\n * @param trackIndex\n * @returns\n */\nexport function playSpineAnimation(\n  spine: sp.Skeleton,\n  animation: string,\n  loop = false,\n  trackIndex = 0\n) {\n  if (loop) {\n    Promise.resolve().then(() => {\n      spine.setAnimation(trackIndex, animation, loop);\n    });\n  }else{\n    return new Promise((resolve) => {\n      let en: sp.spine.TrackEntry = spine.setAnimation(trackIndex, animation, loop);\n      spine.setTrackCompleteListener(en, ()=>{\n        resolve(null);\n      });\n    });\n  }\n}\n\n/**\n *\n * @param url 加载图片路径\n * @returns cc.SpriteFrame\n */\nexport function loadSpriteFrame(\n  url: string\n): Promise<cc.SpriteFrame | undefined> {\n  return new Promise((resolve) => {\n    cc.resources.load(url, cc.SpriteFrame, (err, sprite: cc.SpriteFrame) => {\n      if (err) {\n        console.log(err, \"SpriteFrame 加载失败===============>>\");\n      } else {\n        resolve(sprite);\n      }\n    });\n  });\n}\n","import AudioManager from \"../../../kit/system/audio/AudioManager\";\nimport EventSystem from \"../../../kit/system/event/EventSystem\";\nimport {\n  FOLLOW_CLIENT_TO_MODULE,\n  FOLLOW_MODULE_TO_CLIENT,\n  LIFE_CYCLE_BLOCK,\n  LIFE_CYCLE_COMPLETE,\n  LIFE_CYCLE_UNBLOCK,\n} from \"../../../kit/events/events\";\nimport { playSpineAnimation } from \"./Constant\";\nimport TimerSystem from \"../../../kit/system/timer/TimerSystem\";\nimport ChapterGameComponent from \"../../../common/scripts/ChapterGameComponent\";\n\nconst { ccclass } = cc._decorator;\n\nconst enum DOG_SK {\n  DOUBT = \"doubt\",\n  EXCITED = \"excited\",\n  HAPPY = \"happy\",\n  RUN = \"run\",\n  SAD = \"sad\",\n  STAY = \"stay\",\n  STAY_YAO_QIU = \"stay-yaoqiu\", // 咬球idle\n  YAO_QIU = \"yaoqiu\", // 咬球捡起\n  STAY_YAO_RUN = \"yaoqiu-run\", // 咬球run\n  STAY_FANG_QIU = \"stay-fangqiu\", // 放下球\n}\n\nconst enum BROOM_SK {\n  IDLE = \"saoba-stay\", // 静止不动\n  RUN = \"saoba\",\n}\n\nconst enum BUBBLE_SK {\n  IDLE = \"naopao-2\", // 静止不动\n  SHOW = \"naopao-1\",\n  HIDE = \"naopao-3\",\n}\n\nconst enum MUSIC_TYPE {\n  YELLOW = \"yellow\",\n  RED = \"red\",\n  BG_MUSIC = \"bg\",\n  SEAL = \"SE_luoyefense_03\", // 盖章音效\n  LEAF_SAO = \"SE_luoyefense_04\", // 扫落叶音效\n  DOG_SAD = \"SE_luoyefense_01\", // 狗狗不高兴音效\n  THROW_BALL = \"SE_luoyefense_06\", // 扔球音效\n\n  START = \"1_womenkaishiba\",\n  SO_GOOD = \"2_youaresogood\",\n  kEEP_TRYING = \"3_keeptrying\",\n  COOL = \"4_cool\",\n  PREFECT = \"5_perfect\",\n  GONG_XI = \"6_congratulations\",\n}\n\n@ccclass\nexport default class SweepLeaves extends cc.Component {\n  private dogSk: sp.Skeleton = null;\n  private bubbleSk: sp.Skeleton = null;\n  private broomSk: sp.Skeleton = null;\n  private starSk: sp.Skeleton = null;\n  private leafContent: cc.Node = null;\n  private ballContent: cc.Node = null;\n  private guideNode: cc.Node = null;\n  private tigoHead: cc.Node = null;\n  private blockInputNode: cc.Node = null;\n  private taskNode: cc.Node = null; // 任务节点\n  private hideTaskBtn: cc.Node = null; // 任务按钮节点\n  private gameAudioIndex = 0; // 游戏音频引导\n  private gameIndex = 0; // 游戏关卡\n  private gameTaskIndex = 0; // 游戏任务关卡\n  private isTaskShow = false; // 任务面板是否显示\n  private moveLen = 400; // 任务栏移动距离\n  private taskHideTime = 4; // 任务栏隐藏倒计时\n  private moveTime = 0.5; // 任务栏移动时间\n  private bubble_skin = [\"yezi\", \"huangqiu\", \"hongqiu\", \"huangqiu\"];\n  private leafIndex = []; // 点击叶子数\n  private taskCallback = () => { };\n  private gameTotal = 4;\n  private isClicking = false;\n  private gameWordData: string[] = [\"\", \"黄色\", \"红色\", \"黄色\"];\n  private gameWordAudio: string[] = [\"\", \"yellow\", \"red\", \"yellow\"];\n  private gameReadIcon: string[] = [\"\", \"readYellow\", \"readRed\", \"readYellow\"];\n\n  public MUSIC_PATH: string = \"audio/\";\n  public BUNDLE_NAME: string = \"SweepLeaves\";\n\n  private startRecordFunc = null;\n\n  public onLoad() {\n    EventSystem.on(FOLLOW_MODULE_TO_CLIENT, this.recordResult, this);\n  }\n\n  public start() {\n    this.initAllNode();\n    this.initOnClickLeafNode();\n    this.initOtherNodeMes();\n    this.initTaskNodeMes();\n    this.startRunGame();\n    EventSystem.on(LIFE_CYCLE_BLOCK, this.block, this);\n    EventSystem.on(LIFE_CYCLE_UNBLOCK, this.onBlock, this);\n    this.palyBGM();\n    this.showBlockNode();\n  }\n\n  public block() { }\n\n  public onBlock() { }\n\n  public onDestroy() {\n    EventSystem.off(FOLLOW_MODULE_TO_CLIENT, this.recordResult, this);\n    EventSystem.off(LIFE_CYCLE_BLOCK, this.block, this);\n    EventSystem.off(LIFE_CYCLE_UNBLOCK, this.onBlock, this);\n    if (cc.isValid(this.node)) {\n      this.node.destroy();\n    }\n  }\n\n  private initAllNode() {\n    this.dogSk = this.getSpineByNode(\"dogNode\");\n    this.starSk = this.getSpineByNode(\"starNode\");\n    this.broomSk = this.getSpineByNode(\"broomNode\");\n    this.bubbleSk = this.getSpineByNode(\"bubbleNode\");\n    this.leafContent = this.node.getChildByName(\"leafContent\");\n    this.ballContent = this.node.getChildByName(\"ballContent\");\n    this.blockInputNode = this.node.getChildByName(\"blockInputNode\");\n    this.taskNode = this.node.getChildByName(\"TaskList\");\n    this.hideTaskBtn = this.node.getChildByName(\"hideTaskBtn\");\n    this.tigoHead = this.node.getChildByName(\"tigoHead\");\n    this.guideNode = this.node.getChildByName(\"guideNode\");\n  }\n\n  private initOtherNodeMes() {\n    this.hideTaskBtn.active = false;\n    this.hideTigoHeadAnimation();\n  }\n\n  private showGuideNode() {\n    this.guideNode.active = true;\n  }\n\n  private hideGuideNode() {\n    this.guideNode.active = false;\n  }\n\n  private showBlockNode() {\n    this.blockInputNode.active = true;\n  }\n\n  private hideBlockNode() {\n    this.blockInputNode.active = false;\n  }\n\n  /** 注册叶子点击事件 */\n  private initOnClickLeafNode() {\n    this.leafContent.children.forEach((item) => {\n      item.on(\n        cc.Node.EventType.TOUCH_END,\n        (e) => {\n          this.onClickLeaf(e);\n        },\n        this\n      );\n    });\n  }\n\n  private onClickLeaf(e: cc.Event.EventTouch) {\n    if (this.isClicking) { return; }\n    this.hideGuideNode();\n    this.isClicking = true;\n    this.leafIndex.push(e.target.name);\n    this.gameAudioIndex++;\n    let targetItem = e.target as cc.Node;\n    let leafNode = targetItem.children[0];\n    if (leafNode) {\n      leafNode.active = true;\n      leafNode.getComponent(sp.Skeleton);\n    }\n    this.playBroomAnimation(e.target);\n    this.palyAudioByIdx(e.target.name);\n  }\n\n  /** 播放扫把动画 */\n  private playBroomAnimation(targetNode: cc.Node) {\n    this.broomSk.node.active = true;\n    let tarPos = targetNode.getPosition();\n    this.broomSk.node.setPosition(tarPos.x, tarPos.y - 130);\n    AudioManager.playEffect(\n      this.BUNDLE_NAME,\n      `${this.MUSIC_PATH}${MUSIC_TYPE.LEAF_SAO}`\n    );\n    this.scheduleOnce(() => {\n      this.playBroomEndAnimation(targetNode);\n    }, 2.5);\n  }\n\n  private playBroomEndAnimation(targetNode: cc.Node) {\n    cc.tween(targetNode)\n      .to(0.5, { opacity: 0 })\n      .call(() => {\n        this.playAudioByName();\n        targetNode.active = false;\n        this.broomSk.node.active = false;\n        this.nextGameLevel();\n      })\n      .start();\n  }\n\n  /** 判断是否是下一关 */\n  private async nextGameLevel() {\n    this.isClicking = false;\n    if (this.leafIndex.length < 4) {\n      this.palyDogHappyAnimation();\n      return;\n    }\n    this.gameAudioIndex++;\n    this.gameIndex++;\n    if (this.gameIndex === 1 || this.gameIndex === this.gameTotal) {\n      if (this.gameIndex === 1) {\n        this.showStarAnimation();\n        this.palyDogExcitedAnimation();\n      }\n      TimerSystem.instance.doFrameOnce(1, async () => {\n        await this.showTaskList(false);\n        await this.showSealSpine();\n        await this.hideTaskList();\n        this.hideSealSpine();\n        this.hideStarAnimation();\n        if (this.gameIndex >= this.gameTotal) {\n          // 游戏结束\n          AudioManager.stopMusic();\n          EventSystem.emit(LIFE_CYCLE_COMPLETE);\n          this.palyDogHappyAnimation(true);\n          cc.log(\"游戏结束~~\");\n          return;\n        } else {\n          cc.log(\"游戏继续~~\");\n          this.palyDogIdleAnimation();\n          this.gameTaskIndex++;\n          await this.showTaskList();\n          this.startRecordFunc = async () => {\n            await this.initBubbleMes();\n            await this.showTigoHeadAnimation();\n            this.gameRunRecord();\n          }\n        }\n      });\n    } else {\n      cc.log(\"游戏继续~~ing\");\n      await this.initBubbleMes();\n      await this.showTigoHeadAnimation();\n      this.gameRunRecord();\n    }\n  }\n\n  /** 显示小球 */\n  private showTigoHeadAnimation() {\n    return new Promise<void>((resolve) => {\n      let bubbleName = this.bubble_skin[this.gameIndex];\n      let tarBall = this.ballContent.getChildByName(bubbleName);\n      if (tarBall && bubbleName) {\n        tarBall.active = true;\n        AudioManager.playEffect(\n          this.BUNDLE_NAME,\n          `${this.MUSIC_PATH}${MUSIC_TYPE.THROW_BALL}`\n        );\n        cc.tween(tarBall)\n          .to(0.6, { x: 0, y: 0, scaleX: -0.5, scaleY: 0.5 })\n          .delay(1)\n          .call(() => {\n            resolve();\n          })\n          .start();\n      }\n    });\n  }\n\n  /** 隐藏小球 */\n  private hideTigoHeadAnimation() {\n    this.ballContent.children.forEach((item) => {\n      item.active = false;\n      item.setPosition(this.tigoHead.getPosition());\n    });\n  }\n\n  /** 播放星星闪烁 */\n  private showStarAnimation() {\n    this.starSk.node.active = true;\n  }\n\n  private hideStarAnimation() {\n    this.starSk.node.active = false;\n  }\n\n  /** 播放狗狗happy */\n  private palyDogHappyAnimation(isLoop = false) {\n    // todo 狗叫声音\n    if (isLoop) {\n      playSpineAnimation(this.dogSk, DOG_SK.HAPPY, true);\n      return;\n    }\n    playSpineAnimation(this.dogSk, DOG_SK.HAPPY).then(() => {\n      playSpineAnimation(this.dogSk, DOG_SK.STAY, true);\n    });\n  }\n\n  /** 播放狗狗兴奋 */\n  private palyDogExcitedAnimation() {\n    // todo 狗叫声音\n    playSpineAnimation(this.dogSk, DOG_SK.EXCITED).then(() => {\n      playSpineAnimation(this.dogSk, DOG_SK.STAY, true);\n    });\n  }\n\n  /** 播放狗狗idle */\n  private palyDogIdleAnimation() {\n    // this.dogSk.setSkin(\"default\");\n    playSpineAnimation(this.dogSk, DOG_SK.STAY, true);\n  }\n\n  /** 设置狗狗皮肤 */\n  private setDogBallAnimation() {\n    this.dogSk.setSkin(\"default\");\n    let bubbleName = this.bubble_skin[this.gameIndex];\n    cc.log(`狗狗皮肤名字   ${bubbleName}`);\n    this.dogSk.clearTracks();\n    this.dogSk.setToSetupPose();\n    this.dogSk.setSkin(bubbleName);\n  }\n\n  /** 播放狗狗捡球 */\n  private palyDogBallRightAnimation() {\n    cc.log(\"跟读正确~~\")\n    this.setDogBallAnimation();\n    let originPos = this.dogSk.node.position;\n    let bubbleName = this.bubble_skin[this.gameIndex];\n    let tarBall = this.ballContent.getChildByName(bubbleName);\n    let time = 2;\n    let action1 = cc\n      .tween(this.dogSk.node)\n      .call(() => {\n        playSpineAnimation(this.dogSk, DOG_SK.RUN, true);\n      })\n      .to(time, { x: -183, y: -94, scale: 0.8 })\n      .call(() => {\n        // this.hideTigoHeadAnimation();\n        this.scheduleOnce(() => {\n          this.hideTigoHeadAnimation();\n        }, 0.46)\n        playSpineAnimation(this.dogSk, DOG_SK.YAO_QIU).then(() => {\n          this.dogSk.node.scaleX = -this.dogSk.node.scaleX;\n          playSpineAnimation(this.dogSk, DOG_SK.STAY_YAO_RUN, true);\n          cc.tween(this.dogSk.node)\n            .to(time, { position: originPos, scaleX: -1, scaleY: 1 })\n            .call(() => {\n              this.dogSk.node.scaleX = 1;\n              playSpineAnimation(this.dogSk, DOG_SK.STAY_YAO_QIU).then(() => {\n                playSpineAnimation(this.dogSk, DOG_SK.STAY_FANG_QIU).then(\n                  () => {\n                    playSpineAnimation(this.dogSk, DOG_SK.STAY, true);\n                    this.nextGameLevel();\n                  }\n                );\n              });\n            })\n            .start();\n        });\n      })\n      .start();\n  }\n\n  /** 播放狗狗跟读错误 */\n  private palyDogBallWrongAnimation() {\n    cc.log(\"跟读错误~~\")\n    AudioManager.playEffect(\n      this.BUNDLE_NAME,\n      `${this.MUSIC_PATH}${MUSIC_TYPE.DOG_SAD}`\n    );\n    playSpineAnimation(this.dogSk, DOG_SK.DOUBT).then(() => {\n      playSpineAnimation(this.dogSk, DOG_SK.STAY, true);\n      this.hideTigoHeadAnimation();\n      this.nextGameLevel();\n    });\n  }\n\n  /** 播放背景音效 */\n  private palyBGM() {\n    AudioManager.playMusic(\n      this.BUNDLE_NAME,\n      `${this.MUSIC_PATH}${MUSIC_TYPE.BG_MUSIC}`\n    );\n  }\n\n  /** 播放音频 */\n  private palyAudioByIdx(colorNum: string) {\n    if (Number(colorNum) <= 2) {\n      AudioManager.playEffect(\n        this.BUNDLE_NAME,\n        `${this.MUSIC_PATH}${MUSIC_TYPE.YELLOW}`\n      );\n      return;\n    }\n    AudioManager.playEffect(\n      this.BUNDLE_NAME,\n      `${this.MUSIC_PATH}${MUSIC_TYPE.RED}`\n    );\n  }\n\n  private initTaskNodeMes() {\n    if (!this.taskNode) { return; }\n    let di = this.taskNode.getChildByName(\"di\");\n    let posX = cc.view.getFrameSize().width / 2 + di.width / 2;\n    // let posX = cc.view.getFrameSize().width / 2 + di.width / 2;\n    // this.taskNode.setPosition(posX,0);\n    this.moveLen = di.width;\n    // cc.log(posX, \"this.moveLen===\", this.moveLen);\n    let content = this.taskNode.getChildByName(\"content\");\n    content.children.forEach((item, id) => {\n      item.active = id === this.gameTaskIndex;\n    });\n  }\n\n  /** 显示任务栏 */\n  private showTaskList(bool = true) {\n    return new Promise<void>((resolve) => {\n      this.initTaskNodeMes();\n      this.setTaskCallBack();\n      if (this.isTaskShow) { return; }\n      this.isTaskShow = !this.isTaskShow;\n      cc.tween(this.taskNode)\n        .by(this.moveTime, { x: -this.moveLen })\n        .delay(0.5)\n        .call(() => {\n          this.hideTaskBtn.active = bool;\n          this.hideBlockNode();\n          resolve();\n        })\n        .start();\n    });\n  }\n  /** 隐藏任务栏 */\n  private hideTaskList() {\n    return new Promise<void>((resolve) => {\n      this.cancelTaskCallBack();\n      if (!this.isTaskShow) { return; }\n      this.isTaskShow = !this.isTaskShow;\n      this.hideTaskBtn.active = false;\n      cc.tween(this.taskNode)\n        .by(this.moveTime, { x: this.moveLen })\n        .call(() => {\n          resolve();\n          if (this.gameAudioIndex === 0) {\n            this.playAudioByName();\n            this.showGuideNode();\n          }\n          if (this.startRecordFunc) {\n            this.startRecordFunc();\n            this.startRecordFunc = null;\n          }\n        })\n        .start();\n    });\n  }\n\n  /** 设置倒计时来隐藏任务面板 */\n  private setTaskCallBack() {\n    this.scheduleOnce(\n      (this.taskCallback = () => {\n        this.hideTaskList();\n      }),\n      this.taskHideTime\n    );\n  }\n\n  /** 取消倒计时 */\n  private cancelTaskCallBack() {\n    this.taskCallback && this.unschedule(this.taskCallback);\n  }\n\n  private getSpineByNode(nodeName: string) {\n    let item = this.node.getChildByName(nodeName);\n    if (!item) {\n      cc.warn(`${nodeName}  此节点不存在`);\n      return null;\n    }\n    let targetSk = item.getComponent(sp.Skeleton);\n    if (!targetSk) {\n      cc.warn(`${item.name}  此节点不存在骨骼组件`);\n      return null;\n    }\n    return targetSk;\n  }\n\n  private async startRunGame() {\n    AudioManager.playEffect(\n      this.BUNDLE_NAME,\n      `${this.MUSIC_PATH}${MUSIC_TYPE.DOG_SAD}`\n    );\n    playSpineAnimation(this.dogSk, DOG_SK.SAD).then(() => {\n      playSpineAnimation(this.dogSk, DOG_SK.STAY, true);\n    });\n    await this.initBubbleMes();\n    TimerSystem.instance.doFrameOnce(1, () => {\n      this.showTaskList();\n\n    });\n  }\n\n  private initBubbleMes() {\n    return new Promise<void>((resolve) => {\n      let bubbleName = this.bubble_skin[this.gameIndex];\n      cc.log(\"bubbleName===\", bubbleName);\n      this.bubbleSk.setSkin(bubbleName);\n      this.bubbleSk.clearTracks();\n      this.bubbleSk.setToSetupPose();\n      playSpineAnimation(this.bubbleSk, BUBBLE_SK.SHOW).then(() => {\n        playSpineAnimation(this.bubbleSk, BUBBLE_SK.IDLE, true);\n        cc.tween(this.bubbleSk.node)\n          .delay(2)\n          .call(() => {\n            playSpineAnimation(this.bubbleSk, BUBBLE_SK.HIDE).then(() => {\n              resolve();\n            });\n          })\n          .start();\n      });\n    })\n  }\n\n  /**脑泡展示函数\n   * @param bubbleName 脑泡皮肤名\n   * @returns\n   */\n  private showBubbleSpine(bubbleName: string) {\n    this.bubbleSk.setSkin(bubbleName);\n    this.bubbleSk.clearTracks();\n    this.bubbleSk.setToSetupPose();\n    playSpineAnimation(this.bubbleSk, BUBBLE_SK.SHOW).then(() => {\n      playSpineAnimation(this.bubbleSk, BUBBLE_SK.IDLE, true);\n      this.scheduleOnce(() => {\n        playSpineAnimation(this.bubbleSk, BUBBLE_SK.HIDE);\n      }, 2.5);\n    });\n  }\n\n  private showSealSpine() {\n    return new Promise<void>((resolve) => {\n      let sealNode = this.taskNode.getChildByName(\"sealNode\");\n      sealNode.active = true;\n      let sk = sealNode.getComponent(sp.Skeleton);\n      this.playAudioByName();\n      sk.setToSetupPose();\n      cc.tween(sealNode)\n        .delay(2)\n        .call(() => {\n          resolve();\n        })\n        .start();\n\n      AudioManager.playEffect(\n        this.BUNDLE_NAME,\n        `${this.MUSIC_PATH}${MUSIC_TYPE.SEAL}`\n      );\n    });\n  }\n\n  private hideSealSpine() {\n    let sealNode = this.taskNode.getChildByName(\"sealNode\");\n    if (!sealNode) { return; }\n    let sk = sealNode.getComponent(sp.Skeleton);\n    sk.setToSetupPose();\n    sealNode.active = false;\n  }\n\n  public onClickTaskBtn() {\n    this.hideTaskList();\n  }\n\n  /** 运行跟读环节 */\n  private gameRunRecord() {\n    cc.log(\"gameRunRecord~~~\");\n    // this.scheduleOnce(() => {\n    let recordData = {\n      evaluatingType: 1,\n      evaluatingText: this.gameWordData[this.gameIndex],\n      tryTimes: 1,\n      evaluationScore: 30,\n      recordTime: 3,\n    };\n    EventSystem.emit(FOLLOW_CLIENT_TO_MODULE, {\n      eventName: \"initComponent\",\n      extra: recordData,\n    }); // 初始化录音\n    let startRecordData = {\n      evaluatingText: this.gameWordData[this.gameIndex],\n      bundleName: this.BUNDLE_NAME,\n      audioUrl: `${this.MUSIC_PATH}${this.gameWordAudio[this.gameIndex]}`,\n      iconPath: `res/${this.gameReadIcon[this.gameIndex]}`\n    }\n    EventSystem.emit(FOLLOW_CLIENT_TO_MODULE, { eventName: \"startRecord\", extra: startRecordData }); // 开始录音\n    //}, 2.5);\n    // AudioManager.playEffect(\n    //   this.BUNDLE_NAME,\n    //   `${this.MUSIC_PATH}${this.gameWordAudio[this.gameIndex]}`\n    // );\n\n    //this.startRecordAudio(this.gameWordData[this.gameIndex], this.BUNDLE_NAME, `${this.MUSIC_PATH}${this.gameWordAudio[this.gameIndex]}`, `res/${this.gameReadIcon[this.gameIndex]}`);\n    // if (CC_PREVIEW) {\n    //   this.scheduleOnce(() => {\n    //     let result = { data: { success: true, eventName: \"ResultCb\" } }\n    //     this.onRecordResult(result);\n    //   }, 4);\n    // }\n  }\n\n  /** 检测返回来的结果 */\n  private recordResult(result) {\n    cc.log(\"recordResult\", result.data);\n    if (result.data.eventName == \"ResultCb\") {\n      if (result.data.success) {\n        this.palyDogBallRightAnimation();\n      } else {\n        this.palyDogBallWrongAnimation();\n      }\n    }\n  }\n\n  private playAudioByName() {\n    switch (this.gameAudioIndex) {\n      case 0:\n        AudioManager.playEffect(\n          this.BUNDLE_NAME,\n          `${this.MUSIC_PATH}${MUSIC_TYPE.START}`\n        );\n        break;\n      case 1:\n        AudioManager.playEffect(\n          this.BUNDLE_NAME,\n          `${this.MUSIC_PATH}${MUSIC_TYPE.SO_GOOD}`\n        );\n        break;\n      case 2:\n        AudioManager.playEffect(\n          this.BUNDLE_NAME,\n          `${this.MUSIC_PATH}${MUSIC_TYPE.kEEP_TRYING}`\n        );\n        break;\n      case 3:\n        AudioManager.playEffect(\n          this.BUNDLE_NAME,\n          `${this.MUSIC_PATH}${MUSIC_TYPE.COOL}`\n        );\n        break;\n      case 4:\n        AudioManager.playEffect(\n          this.BUNDLE_NAME,\n          `${this.MUSIC_PATH}${MUSIC_TYPE.PREFECT}`\n        );\n        break;\n      default:\n        AudioManager.playEffect(\n          this.BUNDLE_NAME,\n          `${this.MUSIC_PATH}${MUSIC_TYPE.GONG_XI}`\n        );\n        break;\n    }\n  }\n\n  private playSpineByName(\n    targetSk: sp.Skeleton,\n    startSp: string,\n    endSp: string\n  ) {\n    targetSk.setAnimation(0, startSp, false);\n    targetSk.setEndListener(() => {\n      cc.log(\"setEndListener\");\n      targetSk.addAnimation(0, endSp, true);\n    });\n  }\n}\n"],"file":"index.js"}