{"version":3,"sources":["assets/bundles/quziGamePanda/scripts/QuziGamePanda.ts"],"names":["CompEnum_1","require","AudioManager_1","TemplateGameBase_1","_a","cc","_decorator","ccclass","property","QuziGamePanda","_super","__extends","_this","apply","this","arguments","panda","shucai","baiyan","heiyan","faguang","animationNames","effectUrl","prototype","start","default","playMusic","openAniStart","log","time","curRoundIndex","clearTracks","setAnimation","scheduleOnce","playEffect","addAnimation","node","active","setCompleteListener","roundStateTypeChanged","RoundStateType","RoundOpenAniComplete","openAniComplete","call","schedule","startAudioCallFunc","startRecordAudio","onRecordResult","result","data","eventName","success","RoundComplete","win","endAniStart","unscheduleAllCallbacks","curRoundResult","RoundEndAniComplete","__decorate","type","sp","Skeleton","displayName","exports"],"mappings":"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","sourcesContent":["import { RoundStateType } from \"../../../common/structure/CompEnum\";\nimport AudioManager from \"../../../kit/system/audio/AudioManager\";\nimport TemplateGameBase from \"../../templateGame/scripts/TemplateGameBase\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class QuziGamePanda extends TemplateGameBase {\n\n\n\n    @property({ type: sp.Skeleton, displayName: \"熊猫动画\" })\n    panda: sp.Skeleton = null;\n\n    @property({ type: sp.Skeleton, displayName: \"蔬菜动画\" })\n    shucai: sp.Skeleton = null;\n\n    @property({ type: sp.Skeleton, displayName: \"白烟动画\" })\n    baiyan: sp.Skeleton = null;\n\n    @property({ type: sp.Skeleton, displayName: \"黑烟动画\" })\n    heiyan: sp.Skeleton = null;\n\n    @property({ type: sp.Skeleton, displayName: \"发光动画\" })\n    faguang: sp.Skeleton = null;\n\n\n    animationNames = [\n        [\"daotiaoliao\", \"haowen\", \"daotiaoliao\", \"nanwen\"],\n        [\"jitiaoweijiang\", \"haowen\", \"jitiaoweijiang\", \"nanwen\"]\n    ]\n\n    effectUrl: string = \"res/audios/SE_xiongmaochushen\"\n\n    // onLoad () {}\n\n    start() {\n        AudioManager.playMusic(\"quziGamePanda\", \"res/audios/BGM_guoshengri_01\");\n    }\n\n    openAniStart() {\n        cc.log(\"openAniStart\")\n        let time = 5;\n        switch (this.curRoundIndex) {\n            case 0:\n                this.panda.clearTracks();\n                this.panda.setAnimation(0, \"zou\", false);\n                this.scheduleOnce(() => {\n                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '01', () => {\n                        AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '01');\n                    });\n                }, 1)\n                this.panda.addAnimation(0, \"stay\", true);\n                break;\n            case 1:\n                time = 3;\n                break;\n            case 2:\n                time = 3;\n                this.shucai.node.active = true;\n                this.shucai.clearTracks();\n                this.shucai.setAnimation(0, \"shucai\", false);\n                AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '07');\n                break;\n            case 3:\n                time = 6\n                this.panda.clearTracks();\n                this.panda.setCompleteListener(() => {\n                    this.panda.setCompleteListener(() => {\n                        this.panda.clearTracks();\n                        this.panda.setCompleteListener(() => { });\n                        this.panda.setAnimation(0, \"jiaoban2\", false);\n                        AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '11');\n                    })\n                    this.panda.clearTracks();\n                    this.panda.setAnimation(0, \"jiaoban\", false);\n                })\n                this.panda.setAnimation(0, \"guo\", false);\n\n                break;\n        }\n\n        this.scheduleOnce(() => {\n            this.roundStateTypeChanged(RoundStateType.RoundOpenAniComplete);\n        }, time)\n    }\n\n    openAniComplete() {\n        super.openAniComplete();\n        cc.log(\"openAniComplete\")\n\n        switch (this.curRoundIndex) {\n            case 0:\n            case 1:\n                AudioManager.playEffect(\"quziGamePanda\", \"res/audios/qiqiu\");\n                this.schedule(() => {\n                    AudioManager.playEffect(\"quziGamePanda\", \"res/audios/qiqiu\");\n                }, 5)\n                break;\n            case 2:\n                break;\n        }\n        // let game = cc.instantiate(this.gamePrefabs[this.curRoundIndex]);\n        // this.node.addChild(game);\n        // this.roundNodeArr[0] = game;\n\n        //语音\n        // if (this.curRoundIndex == 3) {\n        //     this.scheduleOnce(() => {\n        //         this.startRecordAudio(\"12122\");\n        //     }, 5)\n        // }\n    }\n\n    startAudioCallFunc() {\n        cc.log(\"GamePanda start record!\")\n        this.startRecordAudio(\"气球\", \"quziGamePanda\", \"res/audios/qiqiu\", \"res/images/bubble\");\n    }\n\n    onRecordResult(result) {\n        cc.log(\"onRecordResult ===== \", result)\n        if (result.data.eventName == 'ResultCb') {\n            if (result.data.success) {\n                this.roundStateTypeChanged(RoundStateType.RoundComplete, { win: 1 })\n            }\n            else {\n                this.roundStateTypeChanged(RoundStateType.RoundComplete, { win: 0 })\n            }\n        }\n    }\n\n    endAniStart() {\n        cc.log(\"endAniStart\")\n        this.unscheduleAllCallbacks();\n        switch (this.curRoundIndex) {\n            case 0:\n                if (this.curRoundResult.win == 1) {\n                    this.panda.clearTracks();\n                    this.panda.setAnimation(0, this.animationNames[this.curRoundIndex][0], false);\n                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '02', () => {\n                        this.scheduleOnce(() => {\n                            AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '03', () => {\n                                this.scheduleOnce(() => {\n                                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '04')\n                                }, 1);\n                            });\n                        }, 0.5)\n                    });\n                    this.panda.addAnimation(0, this.animationNames[this.curRoundIndex][1], false);\n                    this.panda.addAnimation(0, \"stay\", true);\n                }\n                else {\n                    this.panda.clearTracks();\n                    this.panda.setAnimation(0, this.animationNames[this.curRoundIndex][2], false);\n                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '02', () => {\n                        this.scheduleOnce(() => {\n                            AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '03', () => {\n                                this.scheduleOnce(() => {\n                                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '05')\n                                }, 1);\n                            });\n                        }, 0.5)\n                    });\n                    this.panda.addAnimation(0, this.animationNames[this.curRoundIndex][3], false);\n                    this.panda.addAnimation(0, \"stay\", true);\n                }\n                break;\n            case 1:\n                if (this.curRoundResult.win == 1) {\n                    this.panda.clearTracks();\n                    this.panda.setAnimation(0, this.animationNames[this.curRoundIndex][0], false);\n                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '02', () => {\n                        this.scheduleOnce(() => {\n                            AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '06', () => {\n                                this.scheduleOnce(() => {\n                                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '04')\n                                }, 1);\n                            });\n                        }, 0.5)\n                    });\n                    this.panda.addAnimation(0, this.animationNames[this.curRoundIndex][1], false);\n                    this.panda.addAnimation(0, \"stay\", true);\n                }\n                else {\n                    this.panda.clearTracks();\n                    this.panda.setAnimation(0, this.animationNames[this.curRoundIndex][2], false);\n                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '02', () => {\n                        this.scheduleOnce(() => {\n                            AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '06', () => {\n                                this.scheduleOnce(() => {\n                                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '05')\n                                }, 1);\n                            });\n                        }, 0.5)\n                    });\n                    this.panda.addAnimation(0, this.animationNames[this.curRoundIndex][3], false);\n                    this.panda.addAnimation(0, \"stay\", true);\n                }\n                break;\n            case 2:\n                this.shucai.clearTracks();\n                this.shucai.setCompleteListener(() => {\n                    this.shucai.node.active = false;\n                    if (this.curRoundResult.win == 1) {\n                        this.baiyan.node.active = true;\n                        this.baiyan.clearTracks();\n                        this.baiyan.setCompleteListener(() => {\n                            this.panda.clearTracks();\n                            this.panda.setAnimation(0, \"happy\", false);\n                            AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '09');\n                            this.panda.addAnimation(0, \"stay\", true)\n                        })\n                        this.baiyan.setAnimation(0, \"animation\", false);\n                    }\n                    else {\n                        this.heiyan.node.active = true;\n                        this.heiyan.clearTracks();\n                        this.heiyan.setCompleteListener(() => {\n                            this.panda.clearTracks();\n                            this.panda.setAnimation(0, \"aonao\", false);\n                            AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '10');\n                            this.panda.addAnimation(0, \"stay\", true)\n                        })\n                        this.heiyan.setAnimation(0, \"animation\", false);\n                    }\n                })\n                this.shucai.setAnimation(0, \"shucai-fei\", false);\n                AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '08');\n\n                break;\n            case 3:\n                if (this.curRoundResult.win == 1) {\n                    // this.panda.clearTracks();\n                    this.panda.addAnimation(0, \"stay\", true);\n                    this.faguang.node.active = true;\n                    this.faguang.clearTracks();\n                    this.faguang.setAnimation(0, \"animation\", true);\n                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '12');\n                    this.scheduleOnce(() => {\n                        this.panda.clearTracks();\n                        this.panda.setAnimation(0, \"happy\", false);\n                        AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '09');\n                    }, 1);\n                }\n                else {\n                    this.heiyan.node.active = true;\n                    // this.panda.clearTracks();\n                    this.panda.addAnimation(0, \"stay\", true);\n                    this.heiyan.clearTracks();\n                    this.heiyan.setAnimation(0, \"animation\", false);\n                    AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '13');\n                    this.scheduleOnce(() => {\n                        this.panda.clearTracks();\n                        this.panda.setAnimation(0, \"aonao\", false);\n                        AudioManager.playEffect(\"quziGamePanda\", this.effectUrl + '10');\n                    }, 1);\n                }\n\n                break;\n        }\n        this.scheduleOnce(() => {\n            this.roundStateTypeChanged(RoundStateType.RoundEndAniComplete);\n        }, 6)\n\n\n\n    }\n    // update (dt) {}\n}\n"],"file":"index.js"}